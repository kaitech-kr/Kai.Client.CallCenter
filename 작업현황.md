# Kai.Client.CallCenter í”„ë¡œì íŠ¸ ì‘ì—… í˜„í™©

**í”„ë¡œì íŠ¸**: ì½œì„¼í„° í´ë¼ì´ì–¸íŠ¸ (WPF .NET 8.0)
**ì£¼ìš” ê¸°ëŠ¥**: SignalR ì‹¤ì‹œê°„ í†µì‹ , ìë™ë°°ì°¨, OFR ë¬¸ìì¸ì‹, ì£¼ë¬¸/ê³ ê° ê´€ë¦¬

---

## ğŸ“‹ ëª©ì°¨

1. [í”„ë¡œì íŠ¸ ê°œìš”](#í”„ë¡œì íŠ¸-ê°œìš”)
2. [í˜„ì¬ ìƒíƒœ](#í˜„ì¬-ìƒíƒœ)
3. [ì‘ì—… ê¸°ë¡](#ì‘ì—…-ê¸°ë¡)
   - [ì„¸ì…˜ 1: OFR ê¸°ëŠ¥ ë³µêµ¬ ë° ê°œì„  (2025-10-16~18)](#ì„¸ì…˜-1-ofr-ê¸°ëŠ¥-ë³µêµ¬-ë°-ê°œì„ -2025-10-16-18)
   - [ì„¸ì…˜ 2: NwInsung02 ì´ˆê¸°í™” êµ¬í˜„ (2025-10-19)](#ì„¸ì…˜-2-nwinsung02-ì´ˆê¸°í™”-êµ¬í˜„-2025-10-19)
   - [ì„¸ì…˜ 3: ìë™ë°°ì°¨ ë¡œì§ ì„¤ê³„ (2025-10-19)](#ì„¸ì…˜-3-ìë™ë°°ì°¨-ë¡œì§-ì„¤ê³„-2025-10-19)
   - [ì„¸ì…˜ 4: ì£¼ë¬¸/ê³ ê° ê´€ë¦¬ ë¦¬íŒ©í† ë§ (2025-10-20)](#ì„¸ì…˜-4-ì£¼ë¬¸ê³ ê°-ê´€ë¦¬-ë¦¬íŒ©í† ë§-2025-10-20)
   - [ì„¸ì…˜ 5: í´ë” êµ¬ì¡° ì¬êµ¬ì„± (2025-10-21)](#ì„¸ì…˜-5-í´ë”-êµ¬ì¡°-ì¬êµ¬ì„±-2025-10-21)
4. [ì£¼ìš” ê¸°ìˆ  ê°œë…](#ì£¼ìš”-ê¸°ìˆ -ê°œë…)
5. [ë‹¤ìŒ ì‘ì—… ê³„íš](#ë‹¤ìŒ-ì‘ì—…-ê³„íš)

---

## í”„ë¡œì íŠ¸ ê°œìš”

### ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Kai.Client.CallCenter (WPF Client)          â”‚
â”‚ â”œâ”€ SignalR Hub Connection                   â”‚
â”‚ â”œâ”€ ìë™ë°°ì°¨ ì‹œìŠ¤í…œ                           â”‚
â”‚ â”œâ”€ OFR ë¬¸ì ì¸ì‹                            â”‚
â”‚ â””â”€ ì£¼ë¬¸/ê³ ê° ê´€ë¦¬ UI                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†• SignalR (ì‹¤ì‹œê°„ í†µì‹ )
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Kai.Server.Main (ASP.NET Core)              â”‚
â”‚ â”œâ”€ PostgreSQL DB                            â”‚
â”‚ â”œâ”€ SignalR Hub                              â”‚
â”‚ â””â”€ ì—…ë¬´ ë¡œì§                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í•µì‹¬ ëª¨ë“ˆ
- **Networks**: ì™¸ë¶€ ì•± ì—°ë™ (ì¸ì„±1, ì¸ì„±2)
- **OfrWorks**: ê´‘í•™ ë¬¸ì ì¸ì‹ (OFR)
- **Pages**: ì£¼ë¬¸ ìƒíƒœ, ê³ ê° ê´€ë¦¬ í˜ì´ì§€
- **Classes**: ê³µí†µ í´ë˜ìŠ¤, ë§ˆìŠ¤í„° ëª¨ë“œ, ì„œë¸Œ ëª¨ë“œ
- **MVVM**: ViewModel ë° ì„œë¹„ìŠ¤

---

## í˜„ì¬ ìƒíƒœ

### âœ… ì™„ë£Œëœ ê¸°ëŠ¥
- SignalR ì‹¤ì‹œê°„ í†µì‹  êµ¬í˜„
- OFR ë¬¸ì ì¸ì‹ ì‹œìŠ¤í…œ
- NwInsung02 ì´ˆê¸°í™”
- ì£¼ë¬¸/ê³ ê° ê´€ë¦¬ UI
- í´ë” êµ¬ì¡° ì¼ê´€ì„± ê°œì„ 

### ğŸ”§ ì§„í–‰ ì¤‘
- ìë™ë°°ì°¨ ë¡œì§ êµ¬í˜„
- ì™¸ë¶€ ì•± í†µí•© í™•ì¥

### ğŸ“ ê³„íš
- ìë™ë°°ì°¨ í…ŒìŠ¤íŠ¸ ë° ê²€ì¦
- ì„±ëŠ¥ ìµœì í™”

---

## ì‘ì—… ê¸°ë¡

## ì„¸ì…˜ 1: OFR ê¸°ëŠ¥ ë³µêµ¬ ë° ê°œì„  (2025-10-16~18)

### ì‘ì—… ê°œìš”
ë°±ì—… íŒŒì¼ì—ì„œ ì£¼ì„ ì²˜ë¦¬ëœ OFR(Optical Font Recognition) ê´€ë ¨ í•¨ìˆ˜ë“¤ì„ ë³µêµ¬í•˜ê³ , ê°œì„ ì ì„ ì ìš©í•˜ëŠ” ì‘ì—…

### ì£¼ìš” ì‘ì—… ë‚´ìš©

#### 1. OFR í•µì‹¬ í•¨ìˆ˜ ë³µêµ¬

**OfrImage_ExactDrawRelRectAsync** (`OfrWork_Commons.cs`)
- ë³€ìˆ˜ëª… ê°œì„ : `modelText` â†’ `analyText`
- API ì—…ë°ì´íŠ¸: `GetBitmapAnalysisFast`
- Helper í´ë˜ìŠ¤ ìˆ˜ì •: `CommonFuncs_OfrResult`

**OfrIsMatchedImage_DrawRelRectAsync** (`OfrWork_Insungs.cs`)
- ì´ë¯¸ì§€ ë§¤ì¹­ í•¨ìˆ˜ ë³µêµ¬
- Debug ëª¨ë“œ ìˆ˜ë™ ì…ë ¥ ë‹¤ì´ì–¼ë¡œê·¸ ì¶”ê°€

#### 2. í™”ë©´ ìº¡ì²˜ í•¨ìˆ˜ ë³µêµ¬ (`OfrService.cs`)

ë³µêµ¬ëœ í•¨ìˆ˜:
- `CaptureScreen_InArea`
- `CaptureScreen_InRectangle`
- `CaptureScreenRect_InWndHandle` (2ê°œ ì˜¤ë²„ë¡œë“œ)

ê°œì„  ì‚¬í•­:
- XML ë¬¸ì„œ ì£¼ì„ ì¶”ê°€
- ë§¤ê°œë³€ìˆ˜ ìœ íš¨ì„± ê²€ì‚¬
- Debug.WriteLine ë¡œê¹…
- Try-catch ì˜ˆì™¸ ì²˜ë¦¬

#### 3. ë‹¤ì¤‘ Threshold ì €ì¥ êµ¬í˜„

**ImageToMatchedTextWnd.xaml.cs** - ìˆ˜ë™ ì…ë ¥ ë‹¤ì´ì–¼ë¡œê·¸ ë³µêµ¬

```csharp
// ì—¬ëŸ¬ thresholdë¡œ ì €ì¥ (65~254)
byte minThreshold = 65;
byte maxThreshold = 254;
HashSet<string> savedHexStrings = new HashSet<string>(); // ì¤‘ë³µ ë°©ì§€

for (byte threshold = minThreshold; threshold <= maxThreshold; threshold++)
{
    OfrModel_BitmapAnalysis analysis = OfrService.GetBitmapAnalysisFast(bmpExact, threshold);

    if (analysis != null && analysis.sHexArray != null &&
        analysis.trueRate > 0 && analysis.trueRate < 1)
    {
        if (savedHexStrings.Contains(analysis.sHexArray)) continue;
        savedHexStrings.Add(analysis.sHexArray);

        await PgService_TbText.InsertRowAsync(newTbText);
    }
}
```

**ì„¤ê³„ ì´ìœ :**
- ëª¨ë‹ˆí„° ë°ê¸° ì°¨ì´ë¥¼ ê³ ë ¤í•œ ë‹¤ì¤‘ ì„ê³„ê°’ ì €ì¥
- 190ê°œ threshold â†’ ì•½ 100-113ê°œ ê³ ìœ  íŒ¨í„´ (40-47% ì¤‘ë³µ ì œê±°)
- ë‹¤ì–‘í•œ í™˜ê²½ì—ì„œì˜ ì¸ì‹ë¥  í–¥ìƒ

#### 4. ë‹¨ìŒì†Œ ë¬¸ìì—´ ì¸ì‹ í•¨ìˆ˜ êµ¬í˜„

**OfrStr_SeqCharCore** - í•µì‹¬ ì¸ì‹ í•¨ìˆ˜

```csharp
private static async Task<OfrResult_TbCharSetList> OfrStr_SeqCharCore(
    Draw.Bitmap bmpOrg,
    Draw.Rectangle rcSpare,
    bool bUseTbTextStage1,  // â­ Stage 1 ì‚¬ìš© ì—¬ë¶€
    bool bEdit = true,
    bool bWrite = true,
    bool bMsgBox = true)
```

**Threshold ì¬ì‚¬ìš© ì›ì¹™:**
```csharp
// âœ… ì˜¬ë°”ë¥¸ ë°©ì‹ (í•œ ë²ˆë§Œ ê³„ì‚°)
byte threshold = GetAverageBrightness_FromColorBitmapFast(bmpSpare); // ì „ì²´ ì˜ì—­ì—ì„œ 1ë²ˆ

for (int i = 0; i < listStartEnd.Count; i++)
{
    Bitmap bmpChar = ...;
    GetBitmapAnalysisFast(bmpChar, threshold); // ì¬ì‚¬ìš©
}
```

**í•¨ìˆ˜ ê³„ì¸µ êµ¬ì¡°:**
- `OfrStr_SeqWordAsync` - ë°˜ë³µë˜ëŠ” ë‹¨ìŒì†Œ ë‹¨ì–´ (Stage 1+2)
- `OfrStr_SeqCharAsync` - ê°€ë³€ ë‹¨ìŒì†Œ ë°ì´í„° (Stage 2ë§Œ)
- `OfrStr_ComplexCharSetAsync` - ë‹¤ìŒì†Œ ë²”ìš© í•¨ìˆ˜ (Stage 1+2-4)

#### 5. RelChildRects ê³„ì‚° êµ¬í˜„

**InsungsAct_RcptRegPage.cs** - Datagrid ê° ì…€ì˜ ìƒëŒ€ ì¢Œí‘œ ê³„ì‚°

```csharp
// RelChildRects 2ì°¨ì› ë°°ì—´ ìƒì„± [ì—´, í–‰]
m_RcptPage.DGì˜¤ë”_RelChildRects = new Draw.Rectangle[columns, rows];

for (int y = 0; y < rows; y++)
{
    for (int x = 0; x < columns; x++)
    {
        m_RcptPage.DGì˜¤ë”_RelChildRects[x, y] = new Draw.Rectangle(
            listLW[x].nLeft + rcDG_Rel.Left,    // MainWnd ê¸°ì¤€ X
            listTH[y].nTop + rcDG_Rel.Top,      // MainWnd ê¸°ì¤€ Y
            listLW[x].nWidth,
            listTH[y].nHeight
        );
    }
}
```

**ë°ì´í„° êµ¬ì¡°:**
- íƒ€ì…: `Draw.Rectangle[,]` (2ì°¨ì› ë°°ì—´)
- í¬ê¸°: `[20, 30]` (20ê°œ ì»¬ëŸ¼ Ã— 30ê°œ í–‰)
  - í–‰ 0: í—¤ë”
  - í–‰ 1: Empty Row
  - í–‰ 2-29: Data Rows (28ê°œ)

#### 6. GetPixelBrightness í•¨ìˆ˜ ê°œì„ 

**ë¬¸ì œì :**
- ë‘ ì˜¤ë²„ë¡œë“œì˜ null ì²˜ë¦¬ ë°˜í™˜ê°’ì´ ë‹¤ë¦„ (0 vs -1)
- ë²”ìœ„ ê²€ì‚¬ ì—†ìŒ
- ê·¸ë ˆì´ìŠ¤ì¼€ì¼ ê³„ì‚° ê³µì‹ì´ í‘œì¤€ì´ ì•„ë‹˜

**ê°œì„ ëœ í•¨ìˆ˜:**
```csharp
public static byte GetPixelBrightness(Draw.Bitmap bmp, int x, int y)
{
    // 1. Null ê²€ì‚¬
    if (bmp == null) return 0;

    // 2. ë²”ìœ„ ê²€ì‚¬
    if (x < 0 || x >= bmp.Width || y < 0 || y >= bmp.Height) return 0;

    Draw.Color color = bmp.GetPixel(x, y);

    // 3. ITU-R BT.601 í‘œì¤€ ê·¸ë ˆì´ìŠ¤ì¼€ì¼ ê³µì‹
    byte brightness = (byte)((color.R * 0.299) + (color.G * 0.587) + (color.B * 0.114));

    return brightness;
}
```

### OFR ì„¤ê³„ ì›ì¹™

#### 1. Threshold ì¬ì‚¬ìš© ì›ì¹™
- í•œ í…ìŠ¤íŠ¸ ì•ˆì—ì„œëŠ” ì„ê³„ê°’ì´ ê°™ê±°ë‚˜ ë¹„ìŠ·í•¨
- ìƒìœ„ í•¨ìˆ˜ì—ì„œ í•œ ë²ˆ ê³„ì‚° í›„ í•˜ìœ„ í•¨ìˆ˜ì— ì „ë‹¬

#### 2. í•¨ìˆ˜ ê³„ì¸µ êµ¬ì¡°
```
ìƒìœ„ í•¨ìˆ˜ (2ê°œ ë¶„ë¥˜)
â”œâ”€ ë‹¨ìŒì†Œìš©: OfrStr_SeqWordAsync, OfrStr_SeqCharAsync
â”‚  â””â”€ OfrStr_SeqCharCore (private)
â”‚     â””â”€ threshold í•œ ë²ˆ ê³„ì‚°
â””â”€ ë‹¤ìŒì†Œìš©: OfrStr_ComplexCharSetAsync
   â”œâ”€ Stage 1: TbText ì „ì²´ ë§¤ì¹­
   â””â”€ Stage 2-4: RightSliding
```

#### 3. ë²”ìš©ì„± ì›ì¹™
ë‹¤ìŒì†Œìš© í•¨ìˆ˜ëŠ” ë‹¨ìŒì†Œë„ ì²˜ë¦¬ ê°€ëŠ¥í•´ì•¼ í•¨:
- `OfrStr_ComplexCharSetAsync` - í•œê¸€ + ì˜ë¬¸ + ìˆ«ì ëª¨ë‘ ì²˜ë¦¬
- ëŠë¦¬ì§€ë§Œ ì•ˆì „í•¨

### í…ŒìŠ¤íŠ¸ ê²°ê³¼

**"No" ì»¬ëŸ¼ í—¤ë” í…ŒìŠ¤íŠ¸:**
```
[OfrService] GetStartEndList: ê²€ì¶œëœ ë¬¸ì ì˜ì—­ ìˆ˜=2
[OfrStr_SeqCharCore] ë¬¸ì[0] ì¸ì‹ ì„±ê³µ: N
[OfrStr_SeqCharCore] ë¬¸ì[1] ì¸ì‹ ì„±ê³µ: o
[OfrStr_SeqCharCore] ìµœì¢… ê²°ê³¼: No
[OfrStr_SeqCharCore] TbText ì €ì¥ ì„±ê³µ: No
```

### ìˆ˜ì •ëœ íŒŒì¼ (ì„¸ì…˜ 1)
1. `OfrWork_Commons.cs` - OFR í•µì‹¬ í•¨ìˆ˜
2. `OfrWork_Insungs.cs` - ì´ë¯¸ì§€ ë§¤ì¹­
3. `InsungsAct_RcptRegPage.cs` - ì»¬ëŸ¼ í—¤ë” OFR, RelChildRects
4. `OfrService.cs` - í™”ë©´ ìº¡ì²˜, GetPixelBrightness
5. `ImageToMatchedTextWnd.xaml.cs` - ë‹¤ì¤‘ Threshold ì €ì¥

---

## ì„¸ì…˜ 2: NwInsung02 ì´ˆê¸°í™” êµ¬í˜„ (2025-10-19)

### ì‘ì—… ê°œìš”
ì¸ì„±2 ë„¤íŠ¸ì›Œí¬ ì•±(NwInsung02) ì´ˆê¸°í™” ë¡œì§ êµ¬í˜„. ì¸ì„±1ì„ ê¸°ë°˜ìœ¼ë¡œ ë³µì‚¬í•˜ì—¬ ìƒì„±í•˜ê³ , StatusBtn Down ìƒíƒœ OFR í™•ì¸ ë¡œì§ ì¶”ê°€.

### ì£¼ìš” ì‘ì—… ë‚´ìš©

#### 1. NwInsung02.cs ìƒì„±

**ê¸°ë°˜:** NwInsung01.cs ë³µì‚¬

**ì£¼ìš” ë³€ê²½ì‚¬í•­:**
```csharp
// Constants
public const string APP_NAME = StdConst_Network.INSUNG2;
public const string INFO_FILE_NAME = "Insung02_FileInfo.txt";

// IExternalApp êµ¬í˜„
public string AppName => "Insung02";

// ëª¨ë“  Debug ë¡œê·¸ ë° ì—ëŸ¬ ë©”ì‹œì§€
[NwInsung01] â†’ [NwInsung02]
NwInsung01/ â†’ NwInsung02/
```

**ìƒì„±ì Debug ë¡œê·¸:**
```csharp
public NwInsung02()
{
    Debug.WriteLine($"[NwInsung02] ìƒì„±ì í˜¸ì¶œ --------------------------------------------------------");
    Debug.WriteLine($"  APP_NAME = {APP_NAME}");
    Debug.WriteLine($"  s_Id = {s_Id}");
    // ...
}
```

#### 2. appsettings.json ì„¤ì •

```json
"Insung02": {
  "Use": true,
  "Id": "ë™ì‹ MSI-S",
  "Pw": "ilji844200",
  "AppPath": "C:\\Program Files (x86)\\INSUNGDATA\\ì¸ì„±í€µí™”ë¬¼í†µí•©ì†”ë£¨ì…˜\\WooriNetWorkUpdater.exe"
}
```

**ì¸ì„±1ê³¼ì˜ ì°¨ì´ì :**
| êµ¬ë¶„ | ì¸ì„±1 | ì¸ì„±2 |
|------|-------|-------|
| í´ë” | `ì¸ì„±í€µí™”ë¬¼í†µí•©ì†”ë£¨ì…˜_KN` | `ì¸ì„±í€µí™”ë¬¼í†µí•©ì†”ë£¨ì…˜` |
| ì‹¤í–‰íŒŒì¼ | `KoreaNetWorkUpdater.exe` | `WooriNetWorkUpdater.exe` |

#### 3. CommonFuncs.cs - ì„¤ì • ë¡œë“œ

```csharp
// Insung02 ì„¤ì • ë¡œë“œ
string sUse02 = JsonFileManager.GetValue("ExternalApps:Insung02:Use");
NwInsung02.s_Use = StdConvert.StringToBool(sUse02);
NwInsung02.s_Id = JsonFileManager.GetValue("ExternalApps:Insung02:Id");
NwInsung02.s_Pw = JsonFileManager.GetValue("ExternalApps:Insung02:Pw");
NwInsung02.s_AppPath = JsonFileManager.GetValue("ExternalApps:Insung02:AppPath");
```

#### 4. StatusBtn Down ìƒíƒœ OFR ì¶”ê°€ â­

**ë°°ê²½:**
- ë°±ì—… íŒŒì¼ì— Button Down Status ë¡œì§ì´ ì£¼ì„ì²˜ë¦¬ë˜ì–´ ìˆìŒ
- OFR ë°˜ë³µ = UI ìƒíƒœ ë³€í™” ëŒ€ê¸° (í´ë§)

**êµ¬í˜„ íŒ¨í„´:**
```csharp
// 4-2-1. ì ‘ìˆ˜ë²„íŠ¼ Down (ì²« ë²„íŠ¼) - OFR ë£¨í”„ë¡œ Down ìƒíƒœ ëŒ€ê¸°
bool bFoundDownì ‘ìˆ˜ = false;
for (int i = 0; i < CommonVars.c_nRepeatShort; i++)
{
    StdResult_NulBool resultOfrStatusì ‘ìˆ˜ = await OfrWork_Insungs.OfrIsMatchedImage_DrawRelRectAsync(
        m_RcptPage.StatusBtn_hWndì ‘ìˆ˜, HEADER_GAB, "Img_ì ‘ìˆ˜ë²„íŠ¼_Down", false, false, false);

    if (StdConvert.NullableBoolToBool(resultOfrStatusì ‘ìˆ˜.bResult))
    {
        bFoundDownì ‘ìˆ˜ = true;
        Debug.WriteLine($"[InsungsAct_RcptRegPage] ì ‘ìˆ˜ë²„íŠ¼ Down ìƒíƒœ í™•ì¸ ì™„ë£Œ");
        break;
    }
    await Task.Delay(100);
}

// 4-2-2. ì¤‘ê°„ ë²„íŠ¼ë“¤ Down - ë”œë ˆì´ í›„ OFR ë°”ë¡œ
await Task.Delay(300);

StdResult_NulBool resultOfrStatusë°°ì°¨ = await OfrWork_Insungs.OfrIsMatchedImage_DrawRelRectAsync(
    m_RcptPage.StatusBtn_hWndë°°ì°¨, HEADER_GAB, "Img_ë°°ì°¨ë²„íŠ¼_Down", false, false, false);
```

**íŒ¨í„´ ì„¤ëª…:**
1. **ì²« ë²„íŠ¼ (ì ‘ìˆ˜):** for ë£¨í”„ë¡œ Down ìƒíƒœ ë‚˜íƒ€ë‚  ë•Œê¹Œì§€ í´ë§
2. **ì¤‘ê°„ ë²„íŠ¼ë“¤ (ë°°ì°¨, ìš´í–‰, ì™„ë£Œ, ì·¨ì†Œ):** 300ms ë”œë ˆì´ í›„ OFR ë°”ë¡œ ì‹¤í–‰
3. **ë§ˆì§€ë§‰ ë²„íŠ¼ (ì „ì²´):** for ë£¨í”„ë¡œ Down ìƒíƒœ ë‚˜íƒ€ë‚  ë•Œê¹Œì§€ í´ë§

#### 5. ì´ˆê¸°í™” ë¡œì§ ì™„ì„±ë„ ê²€ì¦

**ë°±ì—… íŒŒì¼ê³¼ ë¹„êµ:**
| ë‹¨ê³„ | ë°±ì—… íŒŒì¼ | í˜„ì¬ ì½”ë“œ | ìƒíƒœ |
|------|-----------|-----------|------|
| ë°”ë©”ë‰´ í´ë¦­ | 2ì¤‘ ì£¼ì„ | âœ… ì™„ë£Œ | ê°œì„ ë¨ |
| TopWnd ì°¾ê¸° | âŒ ì—†ìŒ | âœ… ì™„ë£Œ | ì‹ ê·œ ì¶”ê°€ |
| StatusBtn ì°¾ê¸° | ì£¼ì„ | âœ… ì™„ë£Œ | í…ìŠ¤íŠ¸ ê²€ì¦ í¬í•¨ |
| **Button Down Status** | **ì£¼ì„** | **âœ… ì™„ë£Œ** | **ë°©ê¸ˆ ì¶”ê°€** |
| CommandBtn ì°¾ê¸° | ì£¼ì„ | âœ… ì™„ë£Œ | OFR í¬í•¨ |
| Datagrid ì´ˆê¸°í™” | ì£¼ì„ | âœ… ì™„ë£Œ | ì™„ë£Œ |

âœ… **ëˆ„ë½ëœ ë¶€ë¶„ ì—†ìŒ** - ì´ˆê¸°í™” ë¡œì§ ì™„ì„±

#### 6. ê³µí†µ í´ë˜ìŠ¤ êµ¬ì¡°

```
InsungsAct_RcptRegPage (ê³µí†µ í´ë˜ìŠ¤)
    â†‘                    â†‘
NwInsung01          NwInsung02
```

**íŠ¹ì§•:**
- ì¸ì„±1ê³¼ ì¸ì„±2ëŠ” ë™ì¼í•œ `InsungsAct_RcptRegPage` ì¸ìŠ¤í„´ìŠ¤ ì‚¬ìš©
- Contextë¥¼ í†µí•´ AppNameë§Œ ë‹¤ë¥´ê²Œ ì „ë‹¬
- StatusBtn Down ìƒíƒœ OFR ë¡œì§ë„ ì–‘ìª½ ëª¨ë‘ ìë™ ì ìš©ë¨

### ìˆ˜ì •ëœ íŒŒì¼ (ì„¸ì…˜ 2)
1. `Networks\NwInsung02.cs` - ì‹ ê·œ ìƒì„±
2. `appsettings.json` - Insung02 ì„¹ì…˜ ì¶”ê°€
3. `Classes\CommonFuncs.cs` - Insung02 ì„¤ì • ë¡œë“œ
4. `Classes\Class_Master\ExternalAppController.cs` - Insung02 ì´ˆê¸°í™”
5. `Networks\NwInsungs\InsungsAct_RcptRegPage.cs` - StatusBtn Down OFR

---

## ì„¸ì…˜ 3: ìë™ë°°ì°¨ ë¡œì§ ì„¤ê³„ (2025-10-19)

### ì‘ì—… ê°œìš”
NwInsung02 ìë™ë°°ì°¨ ë¡œì§ êµ¬í˜„ì„ ìœ„í•œ ë¶„ì„, ì„¤ê³„, êµ¬í˜„ ì‘ì—…

### AutoAllocAsync í•¨ìˆ˜ ë¶„ì„

**í•¨ìˆ˜ êµ¬ì¡° (5ë‹¨ê³„):**
```
AutoAllocAsync(long lAllocCount, CancelTokenControl ctrl)
â”‚
â”œâ”€ 1. ì‚¬ì „ì‘ì—…
â”‚   â””â”€ TopMost ì„¤ì •
â”‚
â”œâ”€ 2. Local Variables ì´ˆê¸°í™”
â”‚   â”œâ”€ listOrg: AutoAllocCtrl.listForInsung02
â”‚   â”œâ”€ listCreated: ì‹ ê·œ ì˜¤ë”
â”‚   â””â”€ listEtcGroup: ê¸°ì¡´ ì˜¤ë” (Updated, NotChanged ë“±)
â”‚
â”œâ”€ 3. Check Datagrid
â”‚   â””â”€ Datagrid ìœˆë„ìš° ì¡´ì¬ í™•ì¸
â”‚
â”œâ”€ 4. Created Order ì²˜ë¦¬ (ì‹ ê·œ)
â”‚   â””â”€ CheckIsOrderAsync_AssumeKaiNewOrder
â”‚
â””â”€ 5. Updated, NotChanged Order ì²˜ë¦¬
    â”œâ”€ 5-1. ì¡°íšŒë²„íŠ¼ í´ë¦­ + ì´ê³„ í™•ì¸
    â”œâ”€ 5-2. ì˜¤ë” ì´ê°¯ìˆ˜/í˜ì´ì§€ ì‚°ì •
    â””â”€ 5-3. Kaiê°¯ìˆ˜ë§Œí¼ ì‘ì—…
```

**ì¸ì„±1ê³¼ ì¸ì„±2 ì°¨ì´ì  (ë‹¨ 3ê³³ë§Œ!):**
| í•­ëª© | ì¸ì„±1 | ì¸ì„±2 |
|------|-------|-------|
| Debug ë¡œê·¸ | `Insung01` | `Insung02` |
| ì‘ì—… ë¦¬ìŠ¤íŠ¸ | `AutoAllocCtrl.listForInsung01` | `AutoAllocCtrl.listForInsung02` |
| KeyCode í•„ë“œ | `item.TbNewOrder.Insung1` | `item.TbNewOrder.Insung2` |

### Helper í•¨ìˆ˜ êµ¬í˜„

#### 1. WaitPanLoadedAsync (private)
**ëª©ì :** Datagrid ë¡œë”© ì™„ë£Œ ëŒ€ê¸° (Pan ìƒíƒœ ë³€í™” ê°ì§€)

```csharp
private async Task<StdResult> WaitPanLoadedAsync()
{
    // 1. Panì´ ë‚˜íƒ€ë‚  ë•Œê¹Œì§€ ëŒ€ê¸° (ìµœëŒ€ 100ms)
    // 2. Panì´ ì‚¬ë¼ì§ˆ ë•Œê¹Œì§€ ëŒ€ê¸° (ë¡œë”© ì™„ë£Œ)
    // 3. ì‹œê°„ ì´ˆê³¼ ì‹œ Fail ë°˜í™˜
}
```

**ë°˜í™˜:** Success (ì •ìƒ), Skip (Pan ì—†ìŒ), Fail (ì‹œê°„ ì´ˆê³¼)

#### 2. Clickì¡°íšŒë²„íŠ¼Async (public)
**ëª©ì :** ì¡°íšŒ ë²„íŠ¼ í´ë¦­ í›„ ì´ê³„ ì½ê¸°

```csharp
public async Task<StdResult_String> Clickì¡°íšŒë²„íŠ¼Async(CancelTokenControl ctrl)
{
    // 1. ì¡°íšŒ ë²„íŠ¼ í´ë¦­
    // 2. WaitPanLoadedAsync í˜¸ì¶œ
    // 3. CallCount_hWndì´ê³„ì—ì„œ Caption ì½ê¸°
    // 4. ì¬ì‹œë„ (c_nRepeatShort)
}
```

#### 3. ClickEmptyRowAsync (public)
**ëª©ì :** Empty Row í´ë¦­ (ì„ íƒ í•´ì œìš©)

```csharp
public async Task<bool> ClickEmptyRowAsync(CancelTokenControl ctrl)
{
    // 1. Empty Row ì¢Œí‘œ ê³„ì‚° ([0, 1] ì…€)
    // 2. SafeMousePost_ClickLeft_ptRel_WaitBrightChange í˜¸ì¶œ
    // 3. ë°ê¸° ë³€í™” ê°ì§€ë¡œ í´ë¦­ ì„±ê³µ í™•ì¸
    // 4. ì¬ì‹œë„
}
```

### ìë™ë°°ì°¨ ì§„ì… ë¡œì§ ê°œì„ ì•ˆ

#### ê¸°ì¡´ êµ¬ì¡° ë¬¸ì œì 

**âŒ ë¬¸ì œì  1: ì´ì¤‘ Singleton íŒ¨í„´**
```csharp
// CtrlOtherApps - Singleton
public static CtrlOtherApps Instance { get; }

// NwInsung01/02 - ë˜ Singleton
public static NwInsung01 Instance { get; }
```

**âŒ ë¬¸ì œì  2: m_ListApps ë¯¸í™œìš©**
```csharp
// ë¦¬ìŠ¤íŠ¸ë¥¼ ë§Œë“¤ì–´ë†¨ëŠ”ë° ì•ˆ ì”€
public IReadOnlyList<IExternalApp> Apps => m_ListApps.AsReadOnly();

// Instanceë¡œ ì§ì ‘ ì ‘ê·¼
var insung1 = NwInsung01.Instance;
var insung2 = NwInsung02.Instance;
```

**âŒ ë¬¸ì œì  3: ì—ëŸ¬ ì²˜ë¦¬ ì—†ìŒ**
```csharp
resultSts = await insung1.AutoAllocAsync(...);
// resultStsë¥¼ ë°›ì§€ë§Œ ì•„ë¬´ê²ƒë„ ì•ˆí•¨!
```

#### âœ… ê°œì„ ì•ˆ: ë¦¬ìŠ¤íŠ¸ í™œìš© + ì—ëŸ¬ ì²˜ë¦¬

```csharp
// IExternalApp ì¸í„°í˜ì´ìŠ¤ í™•ì¥
public interface IExternalApp : IDisposable
{
    bool IsUsed { get; }
    string AppName { get; }
    Task<StdResult_Status> InitializeAsync();
    void Shutdown();
    Task<StdResult_Status> AutoAllocAsync(long lAllocCount, CancelTokenControl ctrl); // â­ ì¶”ê°€
}

// ExternalAppController
public async Task AutoAllocLoopAsync()
{
    Stopwatch stopwatch = new();
    const int nMinWorkingMiliSec = 5000;

    for (m_lAutoAllocCount = 1; ; m_lAutoAllocCount++)
    {
        try
        {
            // â­ ë£¨í”„ ì‹œì‘ ì‹œ í•œ ë²ˆë§Œ
            await m_CtrlCancelToken.WaitIfPausedOrCancelledAsync();

            stopwatch.Restart();

            // â­ ë¦¬ìŠ¤íŠ¸ í™œìš© - í™•ì¥ ê°€ëŠ¥
            foreach (var app in m_ListApps)
            {
                try
                {
                    var result = await app.AutoAllocAsync(m_lAutoAllocCount, m_CtrlCancelToken);

                    // â­ ì—ëŸ¬ ë¡œê¹…
                    if (result.Result != StdResult.Success)
                    {
                        Debug.WriteLine($"[{app.AppName}] AutoAlloc ì‹¤íŒ¨: {result.sErrNPos}");
                    }
                }
                catch (Exception ex)
                {
                    Debug.WriteLine($"[{app.AppName}] AutoAlloc ì˜ˆì™¸: {ex.Message}");
                }
            }

            // Delay ë³´ì •
            stopwatch.Stop();
            int nDelay = stopwatch.ElapsedMilliseconds < nMinWorkingMiliSec
                ? nMinWorkingMiliSec - (int)stopwatch.ElapsedMilliseconds
                : 0;

            if (nDelay > 0)
                await Task.Delay(nDelay, m_CtrlCancelToken.Token);
        }
        catch (OperationCanceledException)
        {
            Debug.WriteLine("[AutoAllocLoop] ì·¨ì†Œë¨");
            return;
        }
    }
}
```

### ì·¨ì†Œ/Pause ì²´í¬ íŒ¨í„´ ê°€ì´ë“œ â­â­â­

#### ê°œì„  ì›ì¹™: ë ˆë²¨ë³„ ì±…ì„ ë¶„ë‹´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Level 1: Loop (AutoAllocLoopAsync)                 â”‚
â”‚ - ë£¨í”„ ì‹œì‘ ì‹œ 1ë²ˆë§Œ ì²´í¬                           â”‚
â”‚ - Task.Delayì— Token ì „ë‹¬                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Level 2: Task (AutoAllocAsync)                     â”‚
â”‚ - í•¨ìˆ˜ ì§„ì… ì‹œ ì²´í¬ ì•ˆí•¨ (Loopì—ì„œ ì´ë¯¸ ì²´í¬)      â”‚
â”‚ - ë‚´ë¶€ ê¸´ ë£¨í”„ê°€ ìˆìœ¼ë©´ ë£¨í”„ë§ˆë‹¤ ì²´í¬              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Level 3: Action (Clickì¡°íšŒë²„íŠ¼Async ë“±)            â”‚
â”‚ - ë£¨í”„ê°€ ìˆìœ¼ë©´ ë£¨í”„ë§ˆë‹¤ ì²´í¬                      â”‚
â”‚ - Task.Delayì— Token ì „ë‹¬                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Level 4: Helper (ì§§ì€ ì‘ì—…)                        â”‚
â”‚ - ì²´í¬ ì•ˆí•¨                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì²´í¬ í¬ì¸íŠ¸ ê²°ì • ê¸°ì¤€:**
| ìƒí™© | ì²´í¬ ì—¬ë¶€ | ì´ìœ  |
|------|-----------|------|
| **ë¬´í•œ ë£¨í”„ ì‹œì‘** | âœ… í•„ìˆ˜ | ì‘ë‹µì„± |
| **ê¸´ ë£¨í”„ (100+ ë°˜ë³µ)** | âœ… í•„ìˆ˜ | ì·¨ì†Œ ê¸°íšŒ ì œê³µ |
| **ì§§ì€ ë£¨í”„ (10 ì´í•˜)** | âŒ ë¶ˆí•„ìš” | ê³§ ëë‚¨ |
| **í•¨ìˆ˜ ì§„ì… ì‹œ** | âŒ ë¶ˆí•„ìš” | ìƒìœ„ì—ì„œ ì²´í¬ |
| **Task.Delay ì „** | âŒ ë¶ˆí•„ìš” | Token ì „ë‹¬ë¡œ í•´ê²° |

**ì›ì¹™ 1: Task.DelayëŠ” í•­ìƒ Token ì „ë‹¬**
```csharp
// âœ… Good - ì·¨ì†Œ ì‹œ ì¦‰ì‹œ ë°˜ì‘
await Task.Delay(ms, ctrl.Token);

// âŒ Bad - ì·¨ì†Œí•´ë„ msë§Œí¼ ë¬´ì¡°ê±´ ëŒ€ê¸°
await Task.Delay(ms);
```

**ì›ì¹™ 2: í•¨ìˆ˜ ì§„ì… ì‹œ ì²´í¬ ì•ˆí•¨**
```csharp
// âœ… Good
public async Task AutoAllocAsync(...)
{
    // ì§„ì… ì‹œ ì²´í¬ ì•ˆí•¨
    // ë‚´ë¶€ ê¸´ ë£¨í”„ì—ì„œë§Œ ì²´í¬
}
```

### ìˆ˜ì •ëœ íŒŒì¼ (ì„¸ì…˜ 3)
1. `InsungsAct_RcptRegPage.cs` - Helper í•¨ìˆ˜ 3ê°œ ì¶”ê°€
2. (ì„¤ê³„ë§Œ ì™„ë£Œ, êµ¬í˜„ì€ ë‹¤ìŒ ì„¸ì…˜)

---

## ì„¸ì…˜ 4: ì£¼ë¬¸/ê³ ê° ê´€ë¦¬ ë¦¬íŒ©í† ë§ (2025-10-20)

### ì‘ì—… ê°œìš”
ì£¼ë¬¸ ìƒíƒœ ê´€ë¦¬, ê³ ê° ë“±ë¡/ìˆ˜ì •, SignalR ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì£¼ì„ í•´ì œ ë° ë¦¬íŒ©í† ë§

### ì£¼ìš” ì‘ì—… ë‚´ìš©

#### 1. CustMain_RegistPage ì´ˆê¸°í™” ë¬¸ì œ í•´ê²°

**ë¬¸ì œ:**
```csharp
private bool? m_bUsing = null;
public CustMain_RegistPage()
{
    InitializeComponent();
    bool isUsing = m_bUsing.Value; // âŒ null.Value ì ‘ê·¼
}
```

**í•´ê²°:** ë¶ˆí•„ìš”í•œ ì½”ë“œ ì œê±°

#### 2. Order_StatusPage - ì£¼ë¬¸ ìƒíƒœ ë³€ê²½

**ìƒíƒœ ë³€ê²½ ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´ ë¦¬íŒ©í† ë§:**
```csharp
/// <summary>
/// ìƒíƒœë³€ê²½ - ì ‘ìˆ˜ìƒíƒœë¡œ
/// </summary>
private async void OrderContext_ToReceiptState_Click(...)
{
    if (DGridOrder.SelectedItem is not VmOrder_StatusPage_Order selectedOrder) return;

    TbOrder tb = selectedOrder.tbOrder;

    switch (tb.OrderState)
    {
        case "ì ‘ìˆ˜":
            return; // ì´ë¯¸ ì ‘ìˆ˜ ìƒíƒœ

        case "ì·¨ì†Œ":
        case "ëŒ€ê¸°":
            await s_SrGClient.SrMsgBox_OnlyOrderState_UpdateRowAsync_Today(tb, "ì ‘ìˆ˜");
            break;

        default:
            WarnMsgBox($"ì½”ë”©í•´ì•¼í•˜ëŠ” Case: {tb.OrderState}", "OrderContext_ToReceiptState_Click");
            break;
    }
}
```

**ê°œì„  ì‚¬í•­:**
- âœ… Early return íŒ¨í„´ (`is not`)
- âœ… XML ë¬¸ì„œí™”
- âœ… ì¼ê´€ëœ ì—ëŸ¬ ì²˜ë¦¬

**ì½œë³µì‚¬ ê¸°ëŠ¥ êµ¬í˜„:**
```csharp
/// <summary>
/// ì½œë³µì‚¬ - ì ‘ìˆ˜ ìƒíƒœë¡œ ìƒˆë¡œìš´ ì£¼ë¬¸ ìƒì„±
/// </summary>
private async void OrderContext_CopyToReceipt_Click(...)
{
    if (DGridOrder.SelectedItem is not VmOrder_StatusPage_Order selectedOrder) return;

    TbOrder tb = selectedOrder.tbOrder;
    TbOrder tbNew = NetUtil.DeepCopyFrom(tb);
    tbNew.KeyCode = 0; // ìƒˆ ì£¼ë¬¸ì´ë¯€ë¡œ KeyCode ì´ˆê¸°í™”
    tbNew.OrderState = "ì ‘ìˆ˜";

    StdResult_Long result = await s_SrGClient.SrResult_Order_InsertRowAsync_Today(tbNew);
    if (result.lResult <= 0)
    {
        ErrMsgBox($"ì ‘ìˆ˜ ì½œë³µì‚¬ ì‹¤íŒ¨\n{result.sErrNPos}", "OrderContext_CopyToReceipt_Click");
    }
}
```

**ê°œì„ :** 22ì¤„ â†’ 18ì¤„ (22% ê°ì†Œ)

**ì˜¤ë” ì·¨ì†Œ ë²„íŠ¼ êµ¬í˜„:**
```csharp
/// <summary>
/// ì„ íƒëœ ì£¼ë¬¸ì„ ì·¨ì†Œ ìƒíƒœë¡œ ë³€ê²½
/// </summary>
private async void BtnOrderCancel_Click(...)
{
    if (DGridOrder.SelectedItem is not VmOrder_StatusPage_Order selectedOrder)
    {
        ErrMsgBox("ì·¨ì†Œí•  ì£¼ë¬¸ì„ ì„ íƒí•´ì£¼ì„¸ìš”.", "BtnOrderCancel_Click");
        return;
    }

    TbOrder tb = selectedOrder.tbOrder;

    // ì´ë¯¸ ì·¨ì†Œ ìƒíƒœì¸ ê²½ìš°
    if (tb.OrderState == "ì·¨ì†Œ")
    {
        ErrMsgBox("ì´ë¯¸ ì·¨ì†Œëœ ì£¼ë¬¸ì…ë‹ˆë‹¤.", "BtnOrderCancel_Click");
        return;
    }

    // ì£¼ë¬¸ ì·¨ì†Œ ì²˜ë¦¬
    await s_SrGClient.SrMsgBox_OnlyOrderState_UpdateRowAsync_Today(tb, "ì·¨ì†Œ");
}
```

**070 ì „í™” ì‘ë‹µ ì´ë²¤íŠ¸:**
```csharp
/// <summary>
/// 070 ì „í™” ì‘ë‹µ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ - ì „í™”ë²ˆí˜¸ë¡œ ìƒˆ ì£¼ë¬¸ ì ‘ìˆ˜ ì°½ ìë™ ì—´ê¸°
/// </summary>
public async void SrLocalClient_Tel070_AnswerEvent(string telNo)
{
    if (string.IsNullOrWhiteSpace(telNo)) return;

    string phoneNumber = StdConvert.MakePhoneNumberToDigit(telNo);
    await OpenNewOrderWindowAsync(phoneNumber);
}
```

#### 3. SrGlobalClient - SignalR ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬

**ì£¼ë¬¸ ìƒíƒœ ë³€ê²½ ë©”ì„œë“œ:**
```csharp
/// <summary>
/// ì£¼ë¬¸ ìƒíƒœë§Œ ë³€ê²½ (ê°„í¸ ì—…ë°ì´íŠ¸)
/// </summary>
public async Task<StdResult_Int> SrResult_OnlyOrderState_UpdateRowAsync_Today(TbOrder tbOld, string orderState)
{
    TbOrder tbNew = NetUtil.DeepCopyFrom(tbOld);
    tbNew.OrderState = orderState;
    tbNew.Updater = s_CenterCharge.Id;
    tbNew.UpdateDate = DateTime.Now.ToString(StdConst_Var.DTFORMAT_EXCEPT_SEC);

    return await SrResult_Order_UpdateRowAsync_Today(tbNew);
}

public async Task SrMsgBox_OnlyOrderState_UpdateRowAsync_Today(TbOrder tbOld, string orderState)
{
    StdResult_Int result = await SrResult_OnlyOrderState_UpdateRowAsync_Today(tbOld, orderState);

    if (result.nResult <= 0)
    {
        ErrMsgBox($"ì£¼ë¬¸ ìƒíƒœ ë³€ê²½ ì‹¤íŒ¨: {tbOld.OrderState} â†’ {orderState}\n{result.sErrNPos}",
            "SrGlobalClient/SrMsgBox_OnlyOrderState_UpdateRowAsync_Today");
    }
}
```

**ê³ ê° ì •ë³´ ì¡°íšŒ/Insert/Update ë©”ì„œë“œ:**
```csharp
/// <summary>
/// ê³ ê° ì •ë³´ ë‹¨ê±´ ì¡°íšŒ (ê³ ê°, ì„¼í„°, íšŒì‚¬ ì •ë³´ í¬í•¨)
/// </summary>
public async Task<PostgResult_AllWith> SrResult_CustMainWith_Cust_Center_Comp_SelectRowAsync_CenterCode_KeyCode(long lKeyCode)
{
    try
    {
        return await HubConn.InvokeCoreAsync<PostgResult_AllWith>(
            StdConst_FuncName.SrResult.CallCenter.CustMainWith_Cust_Center_Comp_SelectRowAsync_CenterCode_KeyCode,
            new[] { (object)s_CenterCharge.CenterCode, (object)lKeyCode });
    }
    catch (Exception ex)
    {
        return new PostgResult_AllWith(null, StdUtil.GetExceptionMessage(ex),
            "SrGlobalClient/SrResult_CustMainWith_Cust_Center_Comp_SelectRowAsync_CenterCode_KeyCode");
    }
}
```

#### 4. CustMain_RegEditWnd - ê³ ê° ë“±ë¡/ìˆ˜ì • ì°½

**Window_Loaded ë¦¬íŒ©í† ë§ (62ì¤„ â†’ 48ì¤„):**
```csharp
/// <summary>
/// ìœˆë„ìš° ë¡œë“œ ì‹œ ì´ˆê¸°í™” ë° ë°ì´í„° ë¡œë“œ
/// </summary>
private async void Window_Loaded(...)
{
    // ê³µìš© ì´ˆê¸°í™”
    WindowStartupLocation = WindowStartupLocation.CenterOwner;
    TBoxRegister.Text = s_CenterCharge.Id;

    // ì‹ ê·œ ë“±ë¡ëª¨ë“œ
    if (tbAllWithOrg == null)
    {
        // í‚¤ê°€ ìˆìœ¼ë©´ DBì—ì„œ ê³ ê°ì •ë³´ ì¡°íšŒ (ìˆ˜ì •ëª¨ë“œë¡œ ì „í™˜)
        if (lCallCustKeyOrg > 0)
        {
            bool loaded = await LoadCustomerForEditModeAsync();
            if (!loaded) return; // ë¡œë“œ ì‹¤íŒ¨ ì‹œ ì°½ ë‹«í˜
        }
    }
    // ìˆ˜ì •ëª¨ë“œ
    else
    {
        OrgTableToUiData();
    }
}
```

**BtnSave_Click ì™„ì „ ë¦¬íŒ©í† ë§ (70ì¤„ â†’ 24ì¤„, 66% ê°ì†Œ):**
```csharp
/// <summary>
/// ì €ì¥ ë²„íŠ¼ í´ë¦­ - ì‹ ê·œ ë“±ë¡ ë˜ëŠ” ìˆ˜ì •
/// </summary>
private async void BtnSave_Click(...)
{
    // í•„ìˆ˜ì…ë ¥ ì²´í¬
    if (!ValidateRequiredInputs()) return;

    bool success = false;

    // ëª¨ë“œì— ë”°ë¼ ì²˜ë¦¬
    if (tbAllWithOrg == null) // ì‹ ê·œë“±ë¡
    {
        success = await SaveNewCustomerAsync();
    }
    else // ìˆ˜ì •
    {
        success = await UpdateExistingCustomerAsync();
    }

    // ì„±ê³µ ì‹œ ì°½ ë‹«ê¸°
    if (success)
    {
        this.DialogResult = true;
        this.Close();
    }
}
```

**í—¬í¼ ë©”ì„œë“œë“¤:**
1. `ValidateRequiredInputs` - í•„ìˆ˜ ì…ë ¥ ê²€ì¦ + Focus()
2. `SaveNewCustomerAsync` - ì‹ ê·œ ê³ ê° ì €ì¥
3. `UpdateExistingCustomerAsync` - ê¸°ì¡´ ê³ ê° ìˆ˜ì •

**CreateNewTableCopyFromOrg ì‚­ì œ (42ì¤„ â†’ 1ì¤„):**
```csharp
// Before: 42ì¤„ ìˆ˜ë™ ë³µì‚¬
//private void CreateNewTableCopyFromOrg() { ... }

// After: 1ì¤„
tbAllWithNew.custMain = NetUtil.DeepCopyFrom(tbAllWithOrg.custMain);
```

**HasChanges ë©”ì„œë“œ (56ì¤„ â†’ 38ì¤„, 32% ê°ì†Œ):**
```csharp
/// <summary>
/// ë³€ê²½ì‚¬í•­ í™•ì¸ (ìˆ˜ì • ëª¨ë“œìš©)
/// </summary>
private bool HasChanges()
{
    TbCustMain orgCust = tbAllWithOrg.custMain;
    TbCustMain newCust = tbAllWithNew.custMain;

    // ë³€ê²½ë˜ë©´ ì•ˆ ë˜ëŠ” í•„ë“œ ê²€ì¦
    if (orgCust.KeyCode != newCust.KeyCode ||
        orgCust.MemberCode != newCust.MemberCode ||
        orgCust.CenterCode != newCust.CenterCode ||
        orgCust.CompCode != newCust.CompCode)
    {
        return false; // ë¬´ê²°ì„± ì˜¤ë¥˜
    }

    // UIì—ì„œ ìˆ˜ì • ê°€ëŠ¥í•œ í•„ë“œ ë³€ê²½ ê°ì§€
    return orgCust.CustName != newCust.CustName ||
           orgCust.TelNo1 != newCust.TelNo1 ||
           // ... OR ì—°ì‚°ìë¡œ ê°„ê²°í•˜ê²Œ
           orgCust.Using != newCust.Using;
}
```

**ìˆ«ìë§Œ ì…ë ¥ ì œí•œ í™œì„±í™”:**
```csharp
/// <summary>
/// ìˆ«ìë§Œ ì…ë ¥ ê°€ëŠ¥í•˜ë„ë¡ ì œí•œ (ì „í™”ë²ˆí˜¸ ì…ë ¥ìš©)
/// </summary>
private void TBoxOnlyNum_PreviewTextInput(...)
{
    // ì •ê·œì‹: ìˆ«ìê°€ ì•„ë‹Œ ë¬¸ìê°€ ìˆìœ¼ë©´ true ë°˜í™˜ â†’ ì…ë ¥ ì°¨ë‹¨
    e.Handled = s_RegexOnlyNum.IsMatch(e.Text);
}
```

### ì „ì²´ í†µê³„ (ì„¸ì…˜ 4)

**ì½”ë“œ ê°ì†Œ:** ì•½ **300ì¤„ ì´ìƒ**
- CreateNewTableCopyFromOrg ì‚­ì œ: 42ì¤„
- BtnSave_Click ë¦¬íŒ©í† ë§: 46ì¤„ ê°ì†Œ
- HasChanges ë¦¬íŒ©í† ë§: 18ì¤„ ê°ì†Œ
- ê¸°íƒ€ ë¦¬íŒ©í† ë§: ì•½ 200ì¤„ ê°ì†Œ

**ì£¼ìš” ê°œì„  ì‚¬í•­:**
- âœ… NetUtil.DeepCopyFrom í™œìš© (ìˆ˜ë™ ë³µì‚¬ ì œê±°)
- âœ… Early return íŒ¨í„´ (ì¤‘ì²© depth ê°ì†Œ)
- âœ… í—¬í¼ ë©”ì„œë“œ ë¶„ë¦¬ (SRP ì¤€ìˆ˜)
- âœ… XML ë¬¸ì„œí™” (ëª¨ë“  public ë©”ì„œë“œ)
- âœ… ì—ëŸ¬ ë©”ì‹œì§€ ê°œì„  (sErrNPos ì‚¬ìš©)
- âœ… Null ì•ˆì „ì„± (?? "", HasValue)
- âœ… ì‚¬ìš©ì ê²½í—˜ (Focus(), ëª…í™•í•œ ë©”ì‹œì§€)

### ìˆ˜ì •ëœ íŒŒì¼ (ì„¸ì…˜ 4)
1. `Order_StatusPage.xaml.cs` - ì£¼ë¬¸ ìƒíƒœ ê´€ë¦¬
2. `CustMain_RegEditWnd.xaml.cs` - ê³ ê° ë“±ë¡/ìˆ˜ì •
3. `SrGlobalClient.cs` - SignalR í†µì‹ 
4. `ExternalAppController.cs` - ì™¸ë¶€ ì•± ì—°ë™
5. `CustMain_RegistPage.xaml.cs` - ì´ˆê¸°í™” ìˆ˜ì •

---

## ì„¸ì…˜ 5: í´ë” êµ¬ì¡° ì¬êµ¬ì„± (2025-10-21)

### ì‘ì—… ê°œìš”
Class ê´€ë ¨ í´ë”ë“¤ì˜ ì¼ê´€ì„± ê°œì„ ì„ ìœ„í•œ êµ¬ì¡° ì¬êµ¬ì„± ë° ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë³€ê²½

### ì‘ì—… ë‚´ìš©

#### 1. í´ë” ì¬êµ¬ì„±

**Before:**
```
Kai.Client.CallCenter/
â”œâ”€ Class_Common/         (9ê°œ .cs íŒŒì¼)
â”œâ”€ Class_Master/         (3ê°œ .cs íŒŒì¼)
â””â”€ Class_Sub/            (ì„œë¸Œ ëª¨ë“œ)
```

**After:**
```
Kai.Client.CallCenter/
â””â”€ Classes/              (í†µí•© í´ë”)
   â”œâ”€ (9ê°œ .cs íŒŒì¼)     (Common íŒŒì¼ë“¤ì„ ë£¨íŠ¸ë¡œ)
   â”œâ”€ Class_Master/      (í´ë”ì§¸ ì´ë™)
   â””â”€ Class_Sub/         (í´ë”ì§¸ ì´ë™)
```

**ì‘ì—… ë‹¨ê³„:**
1. `Classes/` í´ë” ìƒì„±
2. `Class_Common/` ë‚´ 9ê°œ íŒŒì¼ â†’ `Classes/` ë£¨íŠ¸ë¡œ ì´ë™
3. `Class_Master/` í´ë” â†’ `Classes/` ì•ˆìœ¼ë¡œ ì´ë™
4. `Class_Sub/` í´ë” â†’ `Classes/` ì•ˆìœ¼ë¡œ ì´ë™
5. `Class_Common/` ë¹ˆ í´ë” ì‚­ì œ

#### 2. ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë³€ê²½

**Classes ë£¨íŠ¸ íŒŒì¼ë“¤ (9ê°œ):**
```csharp
// Before
namespace Kai.Client.CallCenter.Class_Common;

// After
namespace Kai.Client.CallCenter.Classes;
```

**ë³€ê²½ëœ íŒŒì¼:**
- CancelTokenControl.cs
- CommonEnums.cs
- CommonFuncs.cs
- CommonVars.cs
- CtrlCppFuncs.cs
- JsonFileManager.cs
- Simulation_Mouse.cs
- SrGlobalClient.cs
- SrLocalClient.cs

**Class_Master íŒŒì¼ë“¤:**
```csharp
// Before
namespace Kai.Client.CallCenter.Class_Master;

// After
namespace Kai.Client.CallCenter.Classes.Class_Master;
```

**Class_Sub íŒŒì¼ë“¤:**
```csharp
// Before
namespace Kai.Client.CallCenter.Class_Sub;

// After
namespace Kai.Client.CallCenter.Classes.Class_Sub;
```

#### 3. Using ë¬¸ ì—…ë°ì´íŠ¸ (23+ íŒŒì¼)

**íŒ¨í„´ 1: ì¼ë°˜ using ë¬¸**
```csharp
// Before
using Kai.Client.CallCenter.Class_Common;
using Kai.Client.CallCenter.Class_Master;
using Kai.Client.CallCenter.Class_Sub;

// After
using Kai.Client.CallCenter.Classes;
using Kai.Client.CallCenter.Classes.Class_Master;
using Kai.Client.CallCenter.Classes.Class_Sub;
```

**íŒ¨í„´ 2: using static ë¬¸**
```csharp
// Before
using static Kai.Client.CallCenter.Class_Common.CommonVars;
using static Kai.Client.CallCenter.Class_Common.SrGlobalClient;
using static Kai.Client.CallCenter.Class_Common.SrLocalClient;

// After
using static Kai.Client.CallCenter.Classes.CommonVars;
using static Kai.Client.CallCenter.Classes.SrGlobalClient;
using static Kai.Client.CallCenter.Classes.SrLocalClient;
```

**ì—…ë°ì´íŠ¸ëœ íŒŒì¼ (ì¼ë¶€):**
- Order_StatusPage.xaml.cs
- SplashWnd.xaml.cs
- MainWnd.xaml.cs
- Company_RegistPage.xaml.cs
- CustMain_RegistPage.xaml.cs
- OfrWork_Commons.cs
- OfrWork_Insungs.cs
- OfrWork_Cargo24.cs
- (ì´ 23+ íŒŒì¼)

#### 4. ëˆ„ë½ëœ using ë¬¸ ì¶”ê°€

**Order_StatusPage.xaml.cs:**
```csharp
// ì¶”ê°€ë¨
using Kai.Client.CallCenter.Classes;

// ê¸°ì¡´ì— ì´ê²ƒë§Œ ìˆì—ˆìŒ
using static Kai.Client.CallCenter.Classes.CommonVars;
```

**MainWnd.xaml.cs:**
```csharp
// ì¶”ê°€ë¨
using Kai.Client.CallCenter.Classes;

// ê¸°ì¡´
using Kai.Client.CallCenter.Classes.Class_Master;
using static Kai.Client.CallCenter.Classes.CommonVars;
```

**ì´ìœ :**
- `CommonFuncs`ëŠ” static classê°€ ì•„ë‹ˆë¯€ë¡œ ì¼ë°˜ using ë¬¸ í•„ìš”
- `using static`ë§Œìœ¼ë¡œëŠ” ì¼ë°˜ í´ë˜ìŠ¤ ì ‘ê·¼ ë¶ˆê°€

#### 5. CS8632 Nullable ê²½ê³  í•´ê²°

**ë¬¸ì œ:**
- `#nullable disable` ì»¨í…ìŠ¤íŠ¸ì—ì„œ `?` nullable ì£¼ì„ ì‚¬ìš©
- CS8632: nullable ì°¸ì¡° í˜•ì‹ì— ëŒ€í•œ ì£¼ì„ì€ '#nullable' ì£¼ì„ ì»¨í…ìŠ¤íŠ¸ ë‚´ì—ë§Œ ì‚¬ìš©ë˜ì–´ì•¼ í•©ë‹ˆë‹¤

**OfrModels.cs ìˆ˜ì •:**
```csharp
// Before
#nullable disable
public class OfrModel_BitmapAnalysis
{
    public byte[]? byteArray { get; set; } = null;      // âŒ
    public BitArray? bitArray { get; set; } = null;     // âŒ
    public Draw.Bitmap? bmpExact { get; set; } = null;  // âŒ
}

// After
#nullable disable
public class OfrModel_BitmapAnalysis
{
    public byte[] byteArray { get; set; } = null;       // âœ…
    public BitArray bitArray { get; set; } = null;      // âœ…
    public Draw.Bitmap bmpExact { get; set; } = null;   // âœ…
}
```

**OfrService.cs ìˆ˜ì •:**
```csharp
// Before
#nullable disable
public static Draw.Bitmap? ConvertSizeBitmap(...) // âŒ

// After
#nullable disable
public static Draw.Bitmap ConvertSizeBitmap(...)  // âœ…
```

#### 6. ë¹Œë“œ ê²°ê³¼

**ì„±ê³µ:**
- âœ… Kai.Client.CallCenter í”„ë¡œì íŠ¸: ì»´íŒŒì¼ ì„±ê³µ
- âœ… ì˜ì¡´ì„± í”„ë¡œì íŠ¸ (Kai.Common.*): ì»´íŒŒì¼ ì„±ê³µ
- âœ… CS8632 ê²½ê³  í•´ê²°

**ë‚¨ì€ ì˜¤ë¥˜:**
- âŒ Kai.Common.FrmDll_FormCtrl: MSB3823/MSB3822 (ë¦¬ì†ŒìŠ¤ ì§ë ¬í™” ì´ìŠˆ)
  - ì´ëŠ” ê¸°ì¡´ ì´ìŠˆì´ë©°, ì´ë²ˆ ì‘ì—…ê³¼ ë¬´ê´€

### ìµœì¢… êµ¬ì¡°

**í´ë” êµ¬ì¡°:**
```
Classes/
â”œâ”€â”€ CancelTokenControl.cs
â”œâ”€â”€ CommonEnums.cs
â”œâ”€â”€ CommonFuncs.cs
â”œâ”€â”€ CommonVars.cs
â”œâ”€â”€ CtrlCppFuncs.cs
â”œâ”€â”€ JsonFileManager.cs
â”œâ”€â”€ Simulation_Mouse.cs
â”œâ”€â”€ SrGlobalClient.cs
â”œâ”€â”€ SrLocalClient.cs
â”œâ”€â”€ Class_Master/
â”‚   â”œâ”€â”€ AutoAlloc.cs
â”‚   â”œâ”€â”€ ExternalAppController.cs
â”‚   â””â”€â”€ MasterModeManager.cs
â””â”€â”€ Class_Sub/
    â””â”€â”€ (ì„œë¸Œ ëª¨ë“œ ê´€ë ¨ íŒŒì¼ë“¤)
```

**ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ê³„ì¸µ:**
```
Kai.Client.CallCenter.Classes
â”œâ”€â”€ (9ê°œ Common í´ë˜ìŠ¤)
â”œâ”€â”€ Kai.Client.CallCenter.Classes.Class_Master
â”‚   â””â”€â”€ (3ê°œ Master í´ë˜ìŠ¤)
â””â”€â”€ Kai.Client.CallCenter.Classes.Class_Sub
    â””â”€â”€ (Sub í´ë˜ìŠ¤ë“¤)
```

### ê°œì„  íš¨ê³¼

1. **ì¼ê´€ì„±:** ëª¨ë“  Class ê´€ë ¨ íŒŒì¼ì´ `Classes/` ì•„ë˜ë¡œ í†µí•©
2. **ëª…í™•ì„±:** ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ê³„ì¸µì´ í´ë” êµ¬ì¡°ì™€ ì¼ì¹˜
3. **í™•ì¥ì„±:** ìƒˆë¡œìš´ ê³µí†µ í´ë˜ìŠ¤ë¥¼ `Classes/` ë£¨íŠ¸ì— ë°”ë¡œ ì¶”ê°€ ê°€ëŠ¥
4. **ì»´íŒŒì¼ ì˜¤ë¥˜ í•´ê²°:** ëª¨ë“  using ë¬¸ ë° ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì •ë¦¬ ì™„ë£Œ

### ìˆ˜ì •ëœ íŒŒì¼ (ì„¸ì…˜ 5)

**í´ë”/íŒŒì¼ ì´ë™:**
- Classes/ (ìƒˆ í´ë”)
- Classes ë£¨íŠ¸ë¡œ ì´ë™: 9ê°œ íŒŒì¼
- Classes ì•ˆìœ¼ë¡œ ì´ë™: Class_Master/, Class_Sub/
- ì‚­ì œ: Class_Common/ (ë¹ˆ í´ë”)

**ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë³€ê²½:**
- Classes ë£¨íŠ¸: 9ê°œ íŒŒì¼
- Class_Master: 3ê°œ íŒŒì¼
- Class_Sub: ë‹¤ìˆ˜ íŒŒì¼

**Using ë¬¸ ì—…ë°ì´íŠ¸:**
- 23+ íŒŒì¼ (Pages, Windows, Networks, OfrWorks ë“±)

**Nullable ê²½ê³  í•´ê²°:**
- OfrModels.cs
- OfrService.cs

---

## ì£¼ìš” ê¸°ìˆ  ê°œë…

### 1. OFR (Optical Font Recognition)

**ê°œë…:**
- DB ê¸°ë°˜ íŒ¨í„´ ë§¤ì¹­ ì‹œìŠ¤í…œìœ¼ë¡œ ë¬¸ì/ì´ë¯¸ì§€ ì¸ì‹
- TbText í…Œì´ë¸”: Width, Height, HexStrValue, Threshold ì •ë³´ ì €ì¥

**Threshold ê¸°ë°˜ ì¸ì‹:**
- ëª¨ë‹ˆí„° ë°ê¸° ì°¨ì´ë¥¼ ê³ ë ¤í•œ ë‹¤ì¤‘ ì„ê³„ê°’ ì €ì¥ (65-254)
- HashSetìœ¼ë¡œ ì¤‘ë³µ ì œê±°í•˜ì—¬ ì•½ 100ê°œ ê³ ìœ  íŒ¨í„´ ì €ì¥

**í•¨ìˆ˜ ê³„ì¸µ:**
```
ìƒìœ„ í•¨ìˆ˜ (Threshold ê³„ì‚°)
â”œâ”€ ë‹¨ìŒì†Œìš©: OfrStr_SeqWordAsync, OfrStr_SeqCharAsync
â””â”€ ë‹¤ìŒì†Œìš©: OfrStr_ComplexCharSetAsync

í•˜ìœ„ í•¨ìˆ˜ (Threshold ë°›ìŒ)
â”œâ”€ GetBitmapAnalysisFast
â”œâ”€ GetForeGroundDrawRectangle_FromColorBitmapFast
â””â”€ GetStartEndList_FromColorBitmap
```

### 2. SignalR ì‹¤ì‹œê°„ í†µì‹ 

**êµ¬ì¡°:**
```csharp
SrGlobalClient (í´ë¼ì´ì–¸íŠ¸)
    â†• SignalR Hub Connection
PgService_* (ì„œë²„ ì„œë¹„ìŠ¤)
    â†• PostgreSQL DB
```

**ì£¼ìš” ë©”ì„œë“œ íŒ¨í„´:**
- `SrResult_*` - ê²°ê³¼ë§Œ ë°˜í™˜
- `SrMsgBox_*` - ê²°ê³¼ + ì—ëŸ¬ ë©”ì‹œì§€ë°•ìŠ¤ í‘œì‹œ

### 3. ìë™ë°°ì°¨ ì‹œìŠ¤í…œ (ì„¤ê³„ ì¤‘)

**êµ¬ì¡°:**
```
ExternalAppController
â”œâ”€ AutoAllocLoopAsync (ë¬´í•œ ë£¨í”„)
â”‚  â””â”€ foreach (IExternalApp app)
â”‚     â””â”€ app.AutoAllocAsync()
â”‚
â””â”€ m_ListApps
   â”œâ”€ NwInsung01
   â””â”€ NwInsung02
```

**ì·¨ì†Œ/Pause íŒ¨í„´:**
- Level 1 (Loop): ë£¨í”„ ì‹œì‘ ì‹œ 1ë²ˆë§Œ ì²´í¬
- Level 2 (Task): ê¸´ ë£¨í”„ë§Œ ì²´í¬
- Level 3 (Action): ë£¨í”„ë§ˆë‹¤ ì²´í¬
- Level 4 (Helper): ì²´í¬ ì•ˆí•¨

### 4. IExternalApp ì¸í„°í˜ì´ìŠ¤

```csharp
public interface IExternalApp : IDisposable
{
    bool IsUsed { get; }
    string AppName { get; }
    Task<StdResult_Status> InitializeAsync();
    Task<StdResult_Status> AutoAllocAsync(long lAllocCount, CancelTokenControl ctrl);
    void Shutdown();
}
```

### 5. Context íŒ¨í„´

```csharp
InsungContext
â”œâ”€ AppName (string)
â”œâ”€ Id (string)
â””â”€ Pw (string)

InsungsModel_Main
â”œâ”€ TopWnd_hWnd (IntPtr)
â”œâ”€ FileInfo (InsungsInfo_File)
â””â”€ RcptPage (InsungsModel_RcptRegPage)
```

### 6. ì£¼ìš” ë¦¬íŒ©í† ë¦¬ë§ íŒ¨í„´

**Early Return:**
```csharp
if (condition is not Type variable) return;
```

**NetUtil.DeepCopyFrom:**
```csharp
TbOrder tbNew = NetUtil.DeepCopyFrom(tbOld);
```

**Null ì•ˆì „ì„±:**
```csharp
string value = field ?? "";
if (nullableDateTime.HasValue) { ... }
```

**ì—ëŸ¬ ë©”ì‹œì§€:**
```csharp
ErrMsgBox($"ì‘ì—… ì‹¤íŒ¨\n{result.sErrNPos}", "MethodName");
```

---

## ë‹¤ìŒ ì‘ì—… ê³„íš

### ìš°ì„ ìˆœìœ„ 1: ìë™ë°°ì°¨ êµ¬í˜„ ì™„ë£Œ
1. **ExternalAppController í™•ì¥**
   - `CancelTokenControl m_CtrlCancelToken` ë³€ìˆ˜
   - `StartAutoAlloc()` ë©”ì„œë“œ
   - `AutoAllocLoopAsync()` ë©”ì„œë“œ (ê°œì„ ëœ êµ¬ì¡°)

2. **IExternalApp ì¸í„°í˜ì´ìŠ¤ í™•ì¥ ì™„ë£Œ**
   - `AutoAllocAsync` ë©”ì„œë“œ ì¶”ê°€ (ì™„ë£Œ)

3. **NwInsung02 AutoAllocAsync êµ¬í˜„**
   - ë‚˜ë¨¸ì§€ Helper í•¨ìˆ˜ êµ¬í˜„
   - AutoAllocAsync ì „ì²´ ë¡œì§ êµ¬í˜„
   - í…ŒìŠ¤íŠ¸ ë° ê²€ì¦

### ìš°ì„ ìˆœìœ„ 2: OFR ê¸°ëŠ¥ ì™„ì„±
1. **OfrStr_ComplexCharSetAsync Stage 2-4 êµ¬í˜„**
   - RightSliding ì•Œê³ ë¦¬ì¦˜ í†µí•©
   - OfrCharSearchDelegate êµ¬í˜„
   - bSaveToTbText ë¡œì§ ì™„ì„±

2. **ì»¬ëŸ¼ í—¤ë” OFR ì ìš©**
   - ëª¨ë“  ì»¬ëŸ¼ í—¤ë”ì— OFR ì ìš©
   - í…ŒìŠ¤íŠ¸ ë° ê²€ì¦

### ìš°ì„ ìˆœìœ„ 3: UI ê°œì„ 
1. ê³ ê° ì¡°íšŒ í˜ì´ì§€ ë¦¬íŒ©í† ë§
2. ì£¼ë¬¸ ê²€ìƒ‰ ê¸°ëŠ¥ ê°œì„ 
3. ìë™ë°°ì°¨ ìƒíƒœ í‘œì‹œ ê°œì„ 

### ë°±ì—… íŒŒì¼ ì°¸ê³ 
- `Backup\Networks\NwInsung02.cs` Lines 211-503 - AutoAllocAsync
- `Backup\Networks\CtrlOtherApps.cs` - ìë™ë°°ì°¨ ì§„ì… ë¡œì§
- `Backup\Networks\InsungsAct_ReceiptPage.cs` - ë‹¤ì–‘í•œ Helper í•¨ìˆ˜ë“¤

---

## í”„ë¡œì íŠ¸ í†µê³„

### ì „ì²´ ì½”ë“œ ë³€ê²½
- **ì´ ê°ì†Œ:** ì•½ 500ì¤„ ì´ìƒ
- **ìƒˆë¡œ ì¶”ê°€:** OFR í•¨ìˆ˜, Helper í•¨ìˆ˜, ì´ˆê¸°í™” ë¡œì§
- **ë¦¬íŒ©í† ë§:** ì£¼ë¬¸/ê³ ê° ê´€ë¦¬, SignalR í†µì‹ 

### íŒŒì¼ ìˆ˜ì • í†µê³„
- **ì„¸ì…˜ 1 (OFR):** 5ê°œ íŒŒì¼
- **ì„¸ì…˜ 2 (NwInsung02):** 5ê°œ íŒŒì¼
- **ì„¸ì…˜ 3 (ìë™ë°°ì°¨ ì„¤ê³„):** 1ê°œ íŒŒì¼ (ì„¤ê³„ ë¬¸ì„œ)
- **ì„¸ì…˜ 4 (ì£¼ë¬¸/ê³ ê°):** 5ê°œ íŒŒì¼
- **ì„¸ì…˜ 5 (í´ë” ì¬êµ¬ì„±):** 35+ íŒŒì¼ (9ê°œ ì´ë™, 23+ using ì—…ë°ì´íŠ¸, 2ê°œ ê²½ê³  ìˆ˜ì •)

### ì£¼ìš” ê°œì„  ì§€í‘œ
- **ì½”ë“œ ê°€ë…ì„±:** Early return, í—¬í¼ ë©”ì„œë“œ ë¶„ë¦¬
- **ì•ˆì •ì„±:** Null ì•ˆì „ì„±, ì—ëŸ¬ ì²˜ë¦¬
- **ìœ ì§€ë³´ìˆ˜:** XML ë¬¸ì„œí™”, ëª…í™•í•œ ì£¼ì„
- **ì„±ëŠ¥:** Threshold ì¬ì‚¬ìš©, foreach í™œìš©
- **ì¼ê´€ì„±:** í´ë” êµ¬ì¡°, ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ê³„ì¸µ

---

**ìµœì¢… ì—…ë°ì´íŠ¸:** 2025-10-21
**ì´ ì„¸ì…˜ ìˆ˜:** 5ê°œ
**ì´ ì‘ì—… ì‹œê°„:** ì•½ 20ì‹œê°„

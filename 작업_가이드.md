# ì‘ì—… ê°€ì´ë“œ

## ğŸ“‹ ì™„ë£Œëœ ì‘ì—…

### 1. ì ‘ìˆ˜ë“±ë¡ - ìš”ê¸ˆ ë° ì˜¤ë”ë©”ëª¨ ì…ë ¥ (2025-10-29)
**íŒŒì¼**: `InsungsAct_RcptRegPage.cs`

**êµ¬í˜„ ë‚´ìš©**:
- ìš”ê¸ˆ ì…ë ¥ (ê¸°ë³¸ìš”ê¸ˆ, ì¶”ê°€ê¸ˆì•¡, í• ì¸ê¸ˆì•¡, íƒì†¡ë£Œ)
  - ë³´ì•ˆìƒ í‚¤ë³´ë“œ ì‹œë®¬ë ˆì´ì…˜ë§Œ ì‚¬ìš© (SetWindowText ë¶ˆê°€)
  - `ResgistAndVerifyìš”ê¸ˆAsync` í•¨ìˆ˜ë¡œ ì…ë ¥ ë° ê²€ì¦
- ì˜¤ë”ë©”ëª¨ ì…ë ¥ (í˜•ì‹: `{KeyCode}/{OrderMemo}`)
  - `WriteAndVerifyEditBoxAsync` ì‚¬ìš©

**í•µì‹¬ í•¨ìˆ˜**:
- `ResgistAndVerifyìš”ê¸ˆAsync` (Line 3739-3765): ìš”ê¸ˆ í•„ë“œ ì…ë ¥/ê²€ì¦, 3íšŒ ì¬ì‹œë„
- `WriteAndVerifyEditBoxAsync` (Line 3011-3071): EditBox ì…ë ¥/ê²€ì¦

### 2. ì ‘ìˆ˜ë“±ë¡ - ì²« ë¡œìš° ì„ íƒ ê²€ì¦ (2025-10-30)
**íŒŒì¼**: `InsungsAct_RcptRegPage.cs`

**êµ¬í˜„ ë‚´ìš©**:
- ì²« ë¡œìš° ì„ íƒ ê²€ì¦ (ì¤‘ì‹¬ ë¼ì¸ í‰ê·  ë°ê¸° ë°©ì‹)
  - ì„ íƒ ì‹œ ë°˜ì „ë˜ì–´ ì–´ë‘ì›Œì§ â†’ `í‰ê·  ë°ê¸° < ë°°ê²½ ë°ê¸° - 10`
- ì²« ë¡œìš° í´ë¦­ í•¨ìˆ˜ ê°œì„  (í´ë¦­ í›„ ê²€ì¦ ë° ì¬ì‹œë„)

**í•µì‹¬ í•¨ìˆ˜**:
- `VerifyFirstRowSelectedAsync` (Line 2541-2603): ì¤‘ì‹¬ ë¼ì¸ í‰ê·  ë°ê¸°ë¡œ ì„ íƒ ê²€ì¦
- `ClickFirstRowAsync` (Line 2482-2539): í´ë¦­ í›„ ê²€ì¦, ì‹¤íŒ¨ ì‹œ ì¬ì‹œë„

### 3. Datagrid ë°°ê²½ ë°ê¸° ì¸¡ì • ë° Region 5-1, 5-3 ê°œì„  (2025-11-02)
**íŒŒì¼**:
- `InsungsAct_RcptRegPage.cs`
- `NwInsung01.cs`

**êµ¬í˜„ ë‚´ìš©**:
1. **ë°°ê²½ ë°ê¸° ì¸¡ì • ìœ„ì¹˜ ìˆ˜ì •**
   - Empty Rowì˜ ìƒ˜í”Œ í¬ì¸íŠ¸ë¥¼ (3,3)ì—ì„œ (8,8)ë¡œ ë³€ê²½
   - ì¸¡ì •ê°’ì´ 211ì—ì„œ 255ë¡œ ê°œì„ ë˜ì–´ ì •í™•ë„ í–¥ìƒ
   - `InsungsAct_RcptRegPage.cs` Line 832

2. **Region 5-1: ì´ê³„ ì½ê¸° ë¡œì§ ê°œì„ **
   - í•œ ë²ˆë§Œ ì‹œë„í•˜ë˜ ë¡œì§ì„ ë°±ì—… ì½”ë“œì²˜ëŸ¼ ë°˜ë³µ êµ¬ì¡°ë¡œ ë³€ê²½
   - ì¡°íšŒë²„íŠ¼ í´ë¦­ê³¼ ì´ê³„ ì½ê¸°ë¥¼ `c_nRepeatNormal`íšŒ ë°˜ë³µ
   - ì‹¤íŒ¨ ì‹œ `c_nWaitNormal` ëŒ€ê¸° í›„ ì¬ì‹œë„
   - `NwInsung01.cs` Line 376-400

3. **Region 5-3: ìœ íš¨ ë¡œìš° ì²´í¬ ë¡œì§ ì™„ì„±**
   - í˜ì´ì§€ë³„ ìœ íš¨ ë¡œìš° ê°¯ìˆ˜ ì¸¡ì • êµ¬í˜„
   - ë°ê¸° ì¸¡ì • ìœ„ì¹˜: `rects[0, y].Right, rects[0, y].Top + 6`
   - ì„ê³„ê°’: `ë°°ê²½ ë°ê¸° - 1`
   - ë°ê¸°ê°€ ì„ê³„ê°’ ë¯¸ë§Œì´ë©´ ìœ íš¨ ë¡œìš°ë¡œ ì¹´ìš´íŠ¸
   - `NwInsung01.cs` Line 465-479

**í•µì‹¬ ë¡œì§**:
```csharp
// Region 5-1: ì´ê³„ ì½ê¸° ì¬ì‹œë„
for (int i = 0; i < c_nRepeatNormal; i++)
{
    StdResult_Status resultQuery = await Clickì¡°íšŒë²„íŠ¼Async(ctrl);
    if (resultQuery.Result == StdResult.Fail) continue;

    sThisTotCount = GetWindowCaption(CallCount_hWndì´ê³„);
    if (!string.IsNullOrEmpty(sThisTotCount)) break;

    await Task.Delay(c_nWaitNormal, ctrl.Token);
}

// Region 5-3: ìœ íš¨ ë¡œìš° ì²´í¬
int nThreshold = nBackgroundBright - 1;
for (int y = 2; y < rects.GetLength(1); y++)
{
    Draw.Point ptCheck = new Draw.Point(rects[0, y].Right, rects[0, y].Top + 6);
    int nCurBright = OfrService.GetPixelBrightness(bmpDG, ptCheck);

    if (nCurBright < nThreshold)
        nValidRows++;
    else
        break;
}
```

### 4. í˜ì´ì§€ ê²€ì¦ ë° ìë™ ì¡°ì • (2025-11-03)
**íŒŒì¼**:
- `InsungsAct_RcptRegPage.cs`
- `InsungsInfo_File.cs`
- `OfrWork_Commons.cs`
- `NwInsung01.cs`

**êµ¬í˜„ ë‚´ìš©**:
1. **GetExpectedFirstRowNum í•¨ìˆ˜** (InsungsAct_RcptRegPage.cs Line 2805-2828)
   - í˜ì´ì§€ë³„ ì˜ˆìƒ ì²« ë¡œìš° ë²ˆí˜¸ ê³„ì‚° (0-based ì¸ë±ìŠ¤)
   - ë§ˆì§€ë§‰ í˜ì´ì§€ íŠ¹ìˆ˜ ì²˜ë¦¬ (ë‚˜ë¨¸ì§€ í–‰ ê³„ì‚°)
   - public staticìœ¼ë¡œ ì„ ì–¸ â†’ ì¸ì„±1, ì¸ì„±2 ê³µí†µ ì‚¬ìš©

2. **ReadFirstRowNumAsync í•¨ìˆ˜** (InsungsAct_RcptRegPage.cs Line 2830-2865)
   - OFRë¡œ ë²ˆí˜¸ ì»¬ëŸ¼(x=0) ì‹¤ì œ ì²« ë²ˆí˜¸ ì½ê¸°
   - bEdit ë§¤ê°œë³€ìˆ˜ë¡œ ëŒ€í™”ìƒì ì œì–´ (ê¸°ë³¸ê°’: false)
   - y=2ë¶€í„° ìˆœì°¨ì ìœ¼ë¡œ OFR ì‹œë„

3. **VerifyAndAdjustPageAsync í•¨ìˆ˜** (InsungsAct_RcptRegPage.cs Line 2867-2943)
   - í˜ì´ì§€ ê²€ì¦ ë° ìë™ ì¡°ì • (ì¬ì‹œë„ 3íšŒ)
   - ìµœì†Œ í´ë¦­ ìµœì í™”: rowClicks > 14ì´ë©´ ì—­ë°©í–¥ ìŠ¤í¬ë¡¤
   - í˜ì´ì§€/ë¡œìš° ìŠ¤í¬ë¡¤ êµ¬ë¶„
   - public ë©”ì„œë“œ â†’ ì¸ì„±1, ì¸ì„±2 ê³µí†µ ì‚¬ìš©

4. **OfrStr_SeqCharAsync ê°œì„ ** (OfrWork_Commons.cs Line 282, 339)
   - bEdit ë§¤ê°œë³€ìˆ˜ ì¶”ê°€ (ê¸°ë³¸ê°’: true)
   - `if (bEdit && s_bDebugMode)` ì¡°ê±´ ì¶”ê°€

5. **ìƒìˆ˜ ë³€ê²½** (InsungsInfo_File.cs Line 129)
   - `ì ‘ìˆ˜ë“±ë¡Page_DGì˜¤ë”_dataRowCount`ë¥¼ constë¡œ ë³€ê²½

**í•µì‹¬ ë¡œì§**:
```csharp
// ì˜ˆìƒ ì²« ë²ˆí˜¸ ê³„ì‚°
int nExpectedFirstNum = GetExpectedFirstRowNum(nTotRows, pageIdx);

// í˜ì´ì§€ ê²€ì¦ ë° ìë™ ì¡°ì •
StdResult_Status result = await VerifyAndAdjustPageAsync(nExpectedFirstNum, ctrl);
if (result.Result == StdResult.Fail)
    return result;

// ìµœì†Œ í´ë¦­ ìµœì í™”
if (rowClicks > dataRowCount / 2)
{
    pageClicks += 1;
    rowClicks = dataRowCount - rowClicks;
    bReverse = true;
}
```

### 5. í˜ì´ì§€ ìº¡ì²˜ ë° ì£¼ë¬¸ë²ˆí˜¸ OFR êµ¬í˜„ (2025-11-03)
**íŒŒì¼**:
- `InsungsAct_RcptRegPage.cs`
- `NwInsung01.cs`

**êµ¬í˜„ ë‚´ìš©**:
1. **GetValidRowCountAsync í•¨ìˆ˜** (InsungsAct_RcptRegPage.cs Line 2952-2981)
   - ìº¡ì²˜ëœ í˜ì´ì§€ ì´ë¯¸ì§€ì—ì„œ ìœ íš¨ ë¡œìš° ê°¯ìˆ˜ ì¸¡ì •
   - ë°ê¸° ì¸¡ì •ìœ¼ë¡œ ì‹¤ì œ ë°ì´í„° ìœ ë¬´ í™•ì¸
   - ì„ê³„ê°’: ë°°ê²½ ë°ê¸° - 1
   - StdResult_Int ë°˜í™˜ (ì—ëŸ¬ ì²˜ë¦¬ í¬í•¨)

2. **GetRowSeqnoAsync í•¨ìˆ˜** (InsungsAct_RcptRegPage.cs Line 2983-3033)
   - ìº¡ì²˜ëœ í˜ì´ì§€ ì´ë¯¸ì§€ì—ì„œ íŠ¹ì • ë¡œìš°ì˜ ì£¼ë¬¸ë²ˆí˜¸ ì½ê¸°
   - GetBitmapInBitmapFastë¡œ ì˜ì—­ crop
   - bInvertRgb ë§¤ê°œë³€ìˆ˜ë¡œ ì„ íƒëœ í–‰ RGB ë°˜ì „ ì²˜ë¦¬
   - OfrStr_SeqCharAsyncë¡œ ì£¼ë¬¸ë²ˆí˜¸ ì¸ì‹
   - StdResult_String ë°˜í™˜

3. **í˜ì´ì§€ ìº¡ì²˜ ë° ì²˜ë¦¬** (NwInsung01.cs Line 447-514)
   - í˜ì´ì§€ë³„ ë°ì´í„°ê·¸ë¦¬ë“œ ì „ì²´ ìº¡ì²˜ (ì¬ì‹œë„ 3íšŒ)
   - try-finallyë¡œ Bitmap ì•ˆì „ í•´ì œ
   - ìœ íš¨ ë¡œìš° ê°¯ìˆ˜ ì–»ê¸°
   - ë§ˆì§€ë§‰ í˜ì´ì§€ startIndex ìë™ ê³„ì‚°
   - ì²« í˜ì´ì§€ ì²« ë¡œìš° ìë™ ì„ íƒ
   - ë¡œìš°ë³„ ì£¼ë¬¸ë²ˆí˜¸ OFR ë° Debug ì¶œë ¥

**í•µì‹¬ ë¡œì§**:
```csharp
// í˜ì´ì§€ ìº¡ì²˜ (ì¬ì‹œë„)
for (int j = 0; j < CommonVars.c_nRepeatShort; j++)
{
    bmpPage = OfrService.CaptureScreenRect_InWndHandle(m_Context.MemInfo.RcptPage.DGì˜¤ë”_hWnd);
    if (bmpPage != null) break;
    await Task.Delay(CommonVars.c_nWaitShort, ctrl.Token);
}

// ìœ íš¨ ë¡œìš° ê°¯ìˆ˜
StdResult_Int resultInt = await m_Context.RcptRegPageAct.GetValidRowCountAsync(bmpPage);

// ë§ˆì§€ë§‰ í˜ì´ì§€ startIndex ê³„ì‚°
int remainder = nThisTotCount % InsungsInfo_File.ì ‘ìˆ˜ë“±ë¡Page_DGì˜¤ë”_dataRowCount;
int startIndex = (pageIdx == nTotPage - 1 && remainder != 0) ?
    InsungsInfo_File.ì ‘ìˆ˜ë“±ë¡Page_DGì˜¤ë”_dataRowCount - remainder : 0;

// ë¡œìš°ë³„ ì£¼ë¬¸ë²ˆí˜¸ ì½ê¸°
for (int i = startIndex, y = i + 2; i < resultInt.nResult; i++, y++)
{
    // ì²« í˜ì´ì§€ ì²« ë¡œìš° ìë™ ì„ íƒ
    if (pageIdx == 0 && i == startIndex) { /* í´ë¦­ */ }

    // ì£¼ë¬¸ë²ˆí˜¸ OFR
    Draw.Rectangle rectSeqno = rects[c_nColì£¼ë¬¸ë²ˆí˜¸, y];
    bool bInvertRgb = (pageIdx == 0 && y == 2);
    StdResult_String resultSeqno = await GetRowSeqnoAsync(bmpPage, rectSeqno, bInvertRgb);
}
```

**ì£¼ìš” ê°œì„ ì **:
- í˜ì´ì§€ë‹¹ 1íšŒ ìº¡ì²˜ë¡œ ì„±ëŠ¥ ìµœì í™” (ì…€ë§ˆë‹¤ ìº¡ì²˜ X)
- ë§ˆì§€ë§‰ í˜ì´ì§€ ë¹ˆ ë¡œìš° ìë™ ê±´ë„ˆëœ€
- ì„ íƒëœ í–‰ RGB ë°˜ì „ ìë™ ì²˜ë¦¬
- try-finallyë¡œ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€

### 6. OFR í•¨ìˆ˜ ì˜¤ë²„ë¡œë“œ íŒ¨í„´ ì ìš© ë° ì½”ë“œ ê°„ì†Œí™” (2025-11-04)
**íŒŒì¼**:
- `OfrWork_Commons.cs`
- `InsungsAct_RcptRegPage.cs`
- `OfrService.cs` (Kai.Common.NetDll_WpfCtrl)

**êµ¬í˜„ ë‚´ìš©**:

1. **OfrStr_SeqCharAsync ì˜¤ë²„ë¡œë“œ ì¶”ê°€** (OfrWork_Commons.cs Line 390-415)
   - íŒŒë¼ë¯¸í„°: `(Draw.Bitmap bmpPage, Draw.Rectangle rect, bool bInvertRgb, bool bEdit = true)`
   - crop + RGB ë°˜ì „ ì²˜ë¦¬ í›„ ê¸°ì¡´ ì˜¤ë²„ë¡œë“œ í˜¸ì¶œ
   - ì¤‘ë³µ ì½”ë“œ ì œê±°ë¡œ ì½”ë“œ ê°„ì†Œí™”

2. **OfrStr_ComplexCharSetAsync ì˜¤ë²„ë¡œë“œ êµ¬ì¡° ìƒì„±** (OfrWork_Commons.cs)
   - **ê¸°ë³¸ ì˜¤ë²„ë¡œë“œ** (Line 420-432): `(Draw.Bitmap bmpSource, bool bInvertRgb, bool bEdit = true)`
     - RGB ë°˜ì „ ì²˜ë¦¬ í›„ ì›ë³¸ í•¨ìˆ˜ í˜¸ì¶œ
     - TODO: êµ¬í˜„ í•„ìš” (ì›ë³¸ í•¨ìˆ˜ì™€ ì—°ë™)
   - **OfrStr_ComplexCharSetAsync2** (Line 442-468): `(Draw.Bitmap bmpPage, Draw.Rectangle rect, bool bInvertRgb, bool bEdit = true)`
     - crop + RGB ë°˜ì „ í›„ ê¸°ë³¸ ì˜¤ë²„ë¡œë“œ í˜¸ì¶œ
     - OfrStr_SeqCharAsyncì™€ ë™ì¼í•œ íŒ¨í„´
   - **ì›ë³¸ í•¨ìˆ˜** (Line 481~): `(Draw.Bitmap bmpOrg, Draw.Rectangle rcSpare, bool bSaveToTbText, bool bEdit, bool bWrite, bool bMsgBox)`
     - ê¸°ì¡´ Stage 1-4 OFR ë¡œì§ ìœ ì§€

3. **InvertBitmapì„ OfrServiceë¡œ ì´ë™** (OfrService.cs Line 1135-1175)
   - ì´ìœ : InsungsAct_RcptRegPage â†’ OfrWork_Commons ì ‘ê·¼ ë¶ˆê°€
   - RGB ë°˜ì „ ë¡œì§: `dstBytes[i] = (byte)(255 - srcBytes[i])`
   - ì¬ì‚¬ìš©ì„± ê°œì„ : ê³µí†µ ìœ í‹¸ë¦¬í‹° ë ˆì´ì–´ë¡œ ì´ë™

4. **í•¨ìˆ˜ ê°„ì†Œí™”** (InsungsAct_RcptRegPage.cs)
   - **GetRowSeqnoAsync** (Line 2991-2995): 40+ lines â†’ 3 lines
     ```csharp
     public async Task<StdResult_String> GetRowSeqnoAsync(Draw.Bitmap bmpPage, Draw.Rectangle rectSeqno, bool bInvertRgb, CancelTokenControl ctrl)
     {
         await ctrl.WaitIfPausedOrCancelledAsync();
         return await OfrWork_Common.OfrStr_SeqCharAsync(bmpPage, rectSeqno, bInvertRgb);
     }
     ```
   - **GetRowStatusAsync** (Line 2956-2960): 40+ lines â†’ 3 lines
     ```csharp
     public async Task<StdResult_String> GetRowStatusAsync(Draw.Bitmap bmpPage, Draw.Rectangle rectStatus, bool bInvertRgb, CancelTokenControl ctrl)
     {
         await ctrl.WaitIfPausedOrCancelledAsync();
         return await OfrWork_Common.OfrStr_ComplexCharSetAsync(bmpPage, rectStatus, bInvertRgb, ctrl);
     }
     ```

**ì˜¤ë²„ë¡œë“œ ê³„ì¸µ êµ¬ì¡°**:
```
OfrStr_SeqCharAsync (ìˆ«ì):
â”œâ”€ (bmpSource, bEdit) â† ì‹¤ì œ OFR ë¡œì§
â””â”€ (bmpPage, rect, bInvertRgb, bEdit) â† crop + RGB ë°˜ì „ í›„ ìœ„ í•¨ìˆ˜ í˜¸ì¶œ

OfrStr_ComplexCharSetAsync (í•œê¸€):
â”œâ”€ (bmpOrg, rcSpare, bSaveToTbText, bEdit, bWrite, bMsgBox) â† ì‹¤ì œ OFR ë¡œì§ (ì›ë³¸)
â”œâ”€ (bmpSource, bInvertRgb, bEdit) â† RGB ë°˜ì „ í›„ ì›ë³¸ í˜¸ì¶œ [TODO: êµ¬í˜„]
â””â”€ OfrStr_ComplexCharSetAsync2(bmpPage, rect, bInvertRgb, bEdit) â† crop + RGB ë°˜ì „ í›„ ê¸°ë³¸ í˜¸ì¶œ
```

**í•µì‹¬ ê°œì„ ì **:
- ì¤‘ë³µ ì½”ë“œ ì œê±°: crop + RGB ë°˜ì „ ë¡œì§ì„ ì˜¤ë²„ë¡œë“œë¡œ í†µí•©
- í•¨ìˆ˜ ê°„ì†Œí™”: 40+ lines â†’ 3 lines (GetRowSeqnoAsync, GetRowStatusAsync)
- ì¬ì‚¬ìš©ì„± ê°œì„ : InvertBitmapì„ ê³µí†µ ë ˆì´ì–´ë¡œ ì´ë™
- ì¼ê´€ëœ íŒ¨í„´: OfrStr_SeqCharAsyncì™€ ë™ì¼í•œ ì˜¤ë²„ë¡œë“œ êµ¬ì¡°

**ë‚¨ì€ ì‘ì—…**:
- [ ] OfrStr_ComplexCharSetAsync ê¸°ë³¸ ì˜¤ë²„ë¡œë“œ êµ¬í˜„ (Line 420-432)
  - RGB ë°˜ì „ ì²˜ë¦¬
  - ì›ë³¸ í•¨ìˆ˜ í˜¸ì¶œ (rcSpare ì „ë‹¬ ë°©ë²• ê²°ì • í•„ìš”)
  - StdResult_String ë°˜í™˜ (OfrResult_TbCharSetList â†’ ë³€í™˜)

**ì»¤ë°‹**: `7fc974b` - refactor: OFR í•¨ìˆ˜ ì˜¤ë²„ë¡œë“œ íŒ¨í„´ ì ìš© ë° ì½”ë“œ ê°„ì†Œí™”

### 7. SignalR ì£¼ë¬¸ ì—…ë°ì´íŠ¸ ì²˜ë¦¬ ë¡œì§ ê°œì„  (2025-11-06)
**íŒŒì¼**:
- `ExternalAppController.cs`
- `QueueController.cs`
- `NwInsung01.cs`
- `InsungsAct_RcptRegPage.cs`

**êµ¬í˜„ ë‚´ìš©**:

1. **StateFlag ë¹„íŠ¸ ì—°ì‚° ì²˜ë¦¬** (NwInsung01.cs Line 574-612)
   - ë¬¸ì œ: switch ë¬¸ìœ¼ë¡œëŠ” ë¹„íŠ¸ í”Œë˜ê·¸(Updated_Status, Updated_Etc) ì²˜ë¦¬ ë¶ˆê°€
   - í•´ê²°: if-else chainìœ¼ë¡œ ë³€ê²½ + ë¹„íŠ¸ AND ì—°ì‚°ì ì‚¬ìš©
   ```csharp
   if ((foundItem.StateFlag & PostgService_Common_OrderState.Existed_WithSeqno) != 0 ||
       (foundItem.StateFlag & PostgService_Common_OrderState.Updated_Assume) != 0)
   {
       // ì²˜ë¦¬ ë¡œì§
   }
   ```

2. **ìƒíƒœ ë¬¸ìì—´ íŒŒì‹±** (NwInsung01.cs Line 567)
   - ë¬¸ì œ: ì¸ì„± ì•± ìƒíƒœê°€ "ì ‘ìˆ˜[1]", "ì ‘ìˆ˜[2]" í˜•ì‹ì¸ë° switchëŠ” "ì ‘ìˆ˜"ë§Œ ì²´í¬
   - í•´ê²°: Substring(0, 2)ë¡œ ì• 2ê¸€ìë§Œ ì¶”ì¶œ
   ```csharp
   string status = resultStatus.strResult.Substring(0, 2); // "ì ‘ìˆ˜[1]" â†’ "ì ‘ìˆ˜"
   ```

3. **í íš¨ìœ¨ì„± ê°œì„ ** (ExternalAppController.cs Line 185-218, 380-386)
   - ë¬¸ì œ: SignalR ì—…ë°ì´íŠ¸ ì‹œ 4ê°œ í ëª¨ë‘ ê²€ìƒ‰
   - í•´ê²°: GetTargetQueues() í•¨ìˆ˜ë¡œ ì°¨ëŸ‰ íƒ€ì…ë³„ ê´€ë ¨ íë§Œ ê²€ìƒ‰
   ```csharp
   // ì˜¤í† /í”Œë ‰ìŠ¤: ì¸ì„±1/2ë§Œ ê²€ìƒ‰
   // ëŒ€í˜• íŠ¸ëŸ­: í™”ë¬¼24ì‹œ/ì›ì½œë§Œ ê²€ìƒ‰
   // ì¼ë°˜: ëª¨ë‘ ê²€ìƒ‰
   var targetQueues = GetTargetQueues(order);
   QueueManager.RemoveFromQueues(order.KeyCode, targetQueues);
   ```

4. **ì¬ì ì¬ ë¡œì§ ìˆ˜ì •** (NwInsung01.cs Line 607-610)
   - ë¬¸ì œ: ì—…ë°ì´íŠ¸ ì„±ê³µ í›„ ê¸°ì¡´ StateFlagë¡œ ì¬ì ì¬ â†’ ë¬´í•œ ë£¨í”„ ê°€ëŠ¥ì„±
   - í•´ê²°: NotChanged í”Œë˜ê·¸ë¡œ ì¬ì ì¬í•˜ì—¬ ê³„ì† ëª¨ë‹ˆí„°ë§
   ```csharp
   case CEnum_AutoAllocProcessResult.SuccessAndReEnqueue:
       ExternalAppController.QueueManager.ReEnqueue(
           foundItem, StdConst_Network.INSUNG1,
           PostgService_Common_OrderState.NotChanged); // â† NotChangedë¡œ ë³€ê²½
       break;
   ```

5. **ì·¨ì†Œ ìƒíƒœ ë¹„ì ì¬ ì²˜ë¦¬** (InsungsAct_RcptRegPage.cs Line 3978-3990, 3734-3736)
   - ë¬¸ì œ: ì·¨ì†Œ ìƒíƒœ ì „í™˜ í›„ì—ë„ ê³„ì† íì—ì„œ ëª¨ë‹ˆí„°ë§ë¨
   - í•´ê²°:
     - **ë‹¤ë¥¸ ìƒíƒœ â†’ ì·¨ì†Œ**: wantState == "ì·¨ì†Œ" ì²´í¬í•˜ì—¬ SuccessAndComplete ë°˜í™˜
     - **ì·¨ì†Œ â†’ ì·¨ì†Œ**: wantStateì— "ì·¨ì†Œ" ì „ë‹¬í•˜ì—¬ ë™ì¼ ë¡œì§ ì¬ì‚¬ìš©
   ```csharp
   // UpdateOrderInPopupAsync
   if (wantState == "ì·¨ì†Œ")
       return CommonResult_AutoAllocProcess.SuccessAndComplete(...); // ë¹„ì ì¬
   else
       return CommonResult_AutoAllocProcess.SuccessAndReEnqueue(...); // ì¬ì ì¬

   // UpdateOrderSameStateAsync
   case "ì·¨ì†Œ":
       useRepeat = false;
       wantState = "ì·¨ì†Œ"; // â† ì¶”ê°€: ë¹„ì ì¬ ì²˜ë¦¬ë¥¼ ìœ„í•´ ì „ë‹¬
       break;
   ```

**í•µì‹¬ ê°œì„ ì **:
- StateFlag ë¹„íŠ¸ ì—°ì‚°ìœ¼ë¡œ ëª¨ë“  ì—…ë°ì´íŠ¸ í”Œë˜ê·¸ ì²˜ë¦¬ ê°€ëŠ¥
- ìƒíƒœ ë¬¸ìì—´ íŒŒì‹±ìœ¼ë¡œ ì¸ì„± ì•± í˜•ì‹ ëŒ€ì‘
- í ê²€ìƒ‰ ìµœì í™”ë¡œ ì„±ëŠ¥ í–¥ìƒ (4ê°œ â†’ 2ê°œ)
- NotChanged í”Œë˜ê·¸ë¡œ ë¬´í•œ ë£¨í”„ ë°©ì§€
- ì·¨ì†Œ ìƒíƒœ ìë™ ë¹„ì ì¬ë¡œ ë¶ˆí•„ìš”í•œ ëª¨ë‹ˆí„°ë§ ì œê±°

**ì»¤ë°‹**: `45bf78c` - fix: SignalR ì£¼ë¬¸ ì—…ë°ì´íŠ¸ ì²˜ë¦¬ ë¡œì§ ê°œì„ 

### 8. Insung ì£¼ë¬¸ ìƒíƒœ ê´€ë¦¬ í•¨ìˆ˜ êµ¬í˜„ (2025-11-07)
**íŒŒì¼**:
- `InsungsAct_RcptRegPage.cs`
- `NwInsung01.cs`
- `AutoAllocModel.cs`

**êµ¬í˜„ ë‚´ìš©**:

1. **CheckIsOrderAsync_InsungOrderManage ë©”ì¸ í•¨ìˆ˜** (InsungsAct_RcptRegPage.cs Line 2216)
   - Insung ì•± ìƒíƒœ ë³€í™” ëª¨ë‹ˆí„°ë§ (NotChanged ìƒí™© ì²˜ë¦¬)
   - Insung ìƒíƒœë¥¼ primary switchë¡œ ë¶„ê¸°
   - ê° Insung ìƒíƒœë³„ handler í•¨ìˆ˜ í˜¸ì¶œ (ì¤‘ì²© switch ë°©ì§€)
   - ë¡œê·¸ ê¸°ë°˜ ê³¨ê²© êµ¬í˜„ (DB ì—…ë°ì´íŠ¸/ì•± ì·¨ì†ŒëŠ” TODO)

2. **Insung ìƒíƒœë³„ Handler í•¨ìˆ˜ë“¤** (InsungsAct_RcptRegPage.cs)
   - **InsungOrderManage_ì ‘ìˆ˜Orë°°ì°¨Async** (Line 2247): ì ‘ìˆ˜/ë°°ì°¨ ìƒíƒœ í†µí•© ì²˜ë¦¬
     - ì •ìƒ: Kai "ì ‘ìˆ˜" + Insung "ì ‘ìˆ˜/ë°°ì°¨"
     - ë¹„ì •ìƒ: Kai "ë°°ì°¨" + Insung "ì ‘ìˆ˜/ë°°ì°¨" â†’ NotChanged í”Œë˜ê·¸ë¡œ ì¬ì ì¬
   - **InsungOrderManage_ìš´í–‰Async** (Line 2286): ìš´í–‰ ìƒíƒœ + 40ì´ˆ íƒ€ì´ë¨¸
     - íƒ€ì´ë¨¸ ì‹œì‘: RunStartTime ì„¤ì •
     - íƒ€ì´ë¨¸ ì²´í¬: 40ì´ˆ ê²½ê³¼ ì‹œ ë¡œê·¸ ì¶œë ¥
     - TODO: Kai DB ì—…ë°ì´íŠ¸ (ì ‘ìˆ˜ â†’ ë°°ì°¨), ë‹¤ë¥¸ ì•± ì·¨ì†Œ
   - **InsungOrderManage_ì™„ë£ŒAsync** (Line 2348): ì™„ë£Œ ìƒíƒœ ì²˜ë¦¬
     - ì •ìƒ: Kai "ë°°ì°¨" + Insung "ì™„ë£Œ"
     - TODO: Kai DB ì—…ë°ì´íŠ¸ (ë°°ì°¨ â†’ ì™„ë£Œ)
   - **InsungOrderManage_ì·¨ì†ŒAsync** (Line 2393): ì·¨ì†Œ ìƒíƒœ ì²˜ë¦¬
     - TODO: Kai DB ì—…ë°ì´íŠ¸, ë‹¤ë¥¸ ì•± ì·¨ì†Œ

3. **AutoAllocModelì— RunStartTime ì¶”ê°€** (AutoAllocModel.cs Line 48-52)
   ```csharp
   /// <summary>
   /// ì¸ì„± "ìš´í–‰" ìƒíƒœ ì§„ì… ì‹œê°„ (40ì´ˆ íƒ€ì´ë¨¸ìš©)
   /// - null: ìš´í–‰ ìƒíƒœ ì•„ë‹˜ ë˜ëŠ” 40ì´ˆ ê²½ê³¼ë¨
   /// - DateTime: ìš´í–‰ ì§„ì… ì‹œê°„ (40ì´ˆ ê²½ê³¼ ì²´í¬ìš©)
   /// </summary>
   public DateTime? RunStartTime { get; set; } = null;
   ```

4. **NwInsung01.cs í˜¸ì¶œ í™œì„±í™”** (Line 577)
   - ì£¼ì„ ì²˜ë¦¬ë˜ì—ˆë˜ í•¨ìˆ˜ í˜¸ì¶œ í™œì„±í™”
   ```csharp
   resultAuto = await m_Context.RcptRegPageAct.CheckIsOrderAsync_InsungOrderManage(foundItem, dgInfoNotChanged, ctrl);
   ```

**í•µì‹¬ ë¡œì§**:
```csharp
// ë©”ì¸ í•¨ìˆ˜: Insung ìƒíƒœë³„ ë¶„ê¸°
switch (insungState)
{
    case "ì ‘ìˆ˜":
    case "ë°°ì°¨":
        return await InsungOrderManage_ì ‘ìˆ˜Orë°°ì°¨Async(item, kaiState, dgInfo, ctrl);
    case "ìš´í–‰":
        return await InsungOrderManage_ìš´í–‰Async(item, kaiState, dgInfo, ctrl);
    case "ì™„ë£Œ":
        return await InsungOrderManage_ì™„ë£ŒAsync(item, kaiState, dgInfo, ctrl);
    case "ì·¨ì†Œ":
        return await InsungOrderManage_ì·¨ì†ŒAsync(item, kaiState, dgInfo, ctrl);
}

// 40ì´ˆ íƒ€ì´ë¨¸ ë¡œì§ (ìš´í–‰ ìƒíƒœ)
if (item.RunStartTime == null)
{
    item.RunStartTime = DateTime.Now;
    Debug.WriteLine($"íƒ€ì´ë¨¸ ì‹œì‘");
}
else
{
    TimeSpan elapsed = DateTime.Now - item.RunStartTime.Value;
    if (elapsed.TotalSeconds >= 40)
    {
        Debug.WriteLine($"40ì´ˆ ê²½ê³¼! ê¸°ì‚¬ í™•ì • ìƒíƒœ");
        // TODO: Kai DB ì—…ë°ì´íŠ¸, ë‹¤ë¥¸ ì•± ì·¨ì†Œ
    }
}

// Kai ë°°ì°¨ + Insung ì ‘ìˆ˜/ë°°ì°¨ ì‹œ ì¬ì ì¬
case "ë°°ì°¨":
    item.StateFlag = PostgService_Common_OrderState.NotChanged;
    return CommonResult_AutoAllocProcess.SuccessAndReEnqueue();
```

**í•µì‹¬ ê°œì„ ì **:
- ì¤‘ì²© switch ë°©ì§€: ê° Insung ìƒíƒœë³„ë¡œ í•¨ìˆ˜ ë¶„ë¦¬
- 40ì´ˆ íƒ€ì´ë¨¸: RunStartTime í•„ë“œë¡œ ìš´í–‰ ì§„ì… ì‹œê°„ ì¶”ì 
- ë¡œê·¸ ê¸°ë°˜ ê³¨ê²©: DB ì—…ë°ì´íŠ¸/ì•± ì·¨ì†ŒëŠ” Phase 2ì—ì„œ êµ¬í˜„
- ì¬ì ì¬ ìµœì í™”: Kai ë°°ì°¨ ìƒíƒœì¼ ë•Œ NotChangedë¡œ ì¬ì ì¬í•˜ì—¬ ë‹¤ì‹œ í™•ì¸
- ìœ ì§€ë³´ìˆ˜ì„±: ê° handler í•¨ìˆ˜ê°€ ë…ë¦½ì ì´ì–´ì„œ ìˆ˜ì • ìš©ì´

**ë‹¤ìŒ ì‘ì—… (Phase 2)**:
- [ ] Kai DB ì—…ë°ì´íŠ¸ í•¨ìˆ˜ êµ¬í˜„
- [ ] ë‹¤ë¥¸ ì•± ì·¨ì†Œ í•¨ìˆ˜ êµ¬í˜„
- [ ] ì¶©ëŒ ê°ì§€ ë¡œì§ ì¶”ê°€ (40ì´ˆ ê²½ê³¼ ì‹œ)
- [ ] ì‹¤ì œ í™˜ê²½ í…ŒìŠ¤íŠ¸

**ì»¤ë°‹**: `a718918` - feat: Insung ì£¼ë¬¸ ìƒíƒœ ê´€ë¦¬ í•¨ìˆ˜ êµ¬í˜„ (Phase 1 - ê³¨ê²© êµ¬í˜„)

---

## ğŸ”§ ì§„í–‰ ì¤‘ ì‘ì—…

### 1. RightSliding ì¬ê·€ ë¡œì§ ê°œì„ 
**ëª©ì **: "123456789"ì²˜ëŸ¼ ë§ì€ ë¬¸ìê°€ ë¶™ì–´ìˆì„ ë•Œ ì¬ê·€ ì²˜ë¦¬

**í˜„ì¬ ë¬¸ì œ**:
- RightSliding 2ë‹¨ê³„ì—ì„œ ë‚˜ë¨¸ì§€ ì˜ì—­ í†µì§¸ë¡œ DB ê²€ìƒ‰
- ì—¬ëŸ¬ ë¬¸ì ë¶™ì–´ìˆìœ¼ë©´ ì‹¤íŒ¨ â†’ "â˜’9" ë¶€ë¶„ ì‹¤íŒ¨ ê²°ê³¼

**í•´ê²° ë°©ì•ˆ**: ê°€ë¡œ/ì„¸ë¡œ ë¹„ìœ¨ ê¸°ì¤€ (1.25ë°°)
```csharp
if (width <= height * 1.25)
{
    // ë‹¨ì¼ ë¬¸ì ê°€ëŠ¥ì„± â†’ ì „ê²½/ë°°ê²½ ë°©ì‹ ë¨¼ì € ì‹œë„
    // ì‹¤íŒ¨ ì‹œ â†’ ì¬ê·€ RightSliding
}
else
{
    // ì—¬ëŸ¬ ë¬¸ì í™•ì‹¤ â†’ ë°”ë¡œ ì¬ê·€ RightSliding
}
```

**ìˆ˜ì • ìœ„ì¹˜**:
- íŒŒì¼: `Ofr_CharSet_Core.cs`
- í•¨ìˆ˜: `RecognizeCharSetAsync_RightSliding`
- Line: 584-655 (2ë‹¨ê³„ ë¶€ë¶„)

### 2. Region 5-3 - ê¸°ì¡´ ì£¼ë¬¸ ì²˜ë¦¬
**ëª©í‘œ**: í˜ì´ì§€ë³„ë¡œ ìˆœíšŒí•˜ë©° ë¦¬ìŠ¤íŠ¸ ì „ì²´ ê²€ì‚¬

**ì™„ë£Œ ìƒíƒœ**:
- âœ… í˜ì´ì§€ë³„ ê²€ì¦ ë° ìº¡ì²˜ (NwInsung01.cs Line 437-459)
- âœ… GetValidRowCountAsync í•¨ìˆ˜ êµ¬í˜„
- âœ… GetRowSeqnoAsync í•¨ìˆ˜ êµ¬í˜„
- âœ… ë§ˆì§€ë§‰ í˜ì´ì§€ startIndex ìë™ ê³„ì‚°
- âœ… ì²« í˜ì´ì§€ ì²« ë¡œìš° ìë™ ì„ íƒ
- âœ… ë¡œìš°ë³„ ì£¼ë¬¸ë²ˆí˜¸ OFR (í…ŒìŠ¤íŠ¸ ì™„ë£Œ)

**ë‚¨ì€ ì‘ì—…**:

**ìš°ì„ ìˆœìœ„ 1: listEtcGroup ìˆœíšŒ ë° ì£¼ë¬¸ë²ˆí˜¸ ë§¤ì¹­**
- [ ] listEtcGroup ì—­ìˆœ ìˆœíšŒ êµ¬í˜„
- [ ] ì½ì€ ì£¼ë¬¸ë²ˆí˜¸ì™€ listEtcGroupì˜ Insung1 ë¹„êµ
- [ ] ì°¾ìœ¼ë©´ í•´ë‹¹ í•­ëª©ì˜ StateFlagì— ë”°ë¼ ì²˜ë¦¬
- **êµ¬í˜„ ìœ„ì¹˜**: NwInsung01.cs Line 481 for ë£¨í”„ ë‚´ë¶€
- **ë¡œì§**:
  ```csharp
  for (int i = startIndex, y = i + 2; i < resultInt.nResult; i++, y++)
  {
      // ì£¼ë¬¸ë²ˆí˜¸ ì½ê¸°
      string seqno = resultSeqno.strResult;

      // listEtcGroupì—ì„œ ì°¾ê¸° (ì—­ìˆœ)
      for (int listIdx = listEtcGroup.Count - 1; listIdx >= 0; listIdx--)
      {
          if (listEtcGroup[listIdx].NewOrder.Insung1 == seqno)
          {
              // ì°¾ìŒ â†’ StateFlagë³„ ì²˜ë¦¬
              break;
          }
      }
  }
  ```

**ìš°ì„ ìˆœìœ„ 2: StateFlagë³„ ì²˜ë¦¬ êµ¬í˜„**
```csharp
// í˜„ì¬ í˜ì´ì§€ ìº¡ì²˜ â†’ í–‰ë³„ ì£¼ë¬¸ë²ˆí˜¸ ì½ê¸° â†’ ì°¾ìœ¼ë©´ í–‰ ì¸ë±ìŠ¤ ì €ì¥
for (int rowIdx = 2; rowIdx < nRowsPerPage + 2; rowIdx++)
{
    string sPageSeqno = OFRë¡œ_ì£¼ë¬¸ë²ˆí˜¸_ì½ê¸°(bmpPage, rowIdx);
    if (sPageSeqno == sSeqNo) { /* ì°¾ìŒ */ }
}
```

**ìš°ì„ ìˆœìœ„ 4: StateFlag ì²˜ë¦¬** (Line 438-449)
- [x] CheckIsOrderAsync_InsungOrderManage êµ¬í˜„ (2025-11-07 ì™„ë£Œ)
- [ ] Command_ChaneToì·¨ì†ŒAndDoDelete êµ¬í˜„
- [ ] CheckIsOrderAsync_AssumeKaiUpdated êµ¬í˜„
- [ ] ì¬ì ì¬ ë¡œì§ êµ¬í˜„

**í•µì‹¬ ì•Œê³ ë¦¬ì¦˜**:
```csharp
// í˜ì´ì§€ë³„ ìˆœíšŒ
for (int pageIdx = 1; pageIdx <= nTotPage; pageIdx++)
{
    // 1. í˜ì´ì§€ ì´ë™
    // 2. í˜ì´ì§€ ìº¡ì²˜

    // ë¦¬ìŠ¤íŠ¸ ì „ì²´ ê²€ì‚¬ (ì—­ìˆœ - ì‚­ì œ ì•ˆì „)
    for (int no = listEtcGroup.Count; no > 0; no--)
    {
        // 3. í˜„ì¬ í˜ì´ì§€ì—ì„œ ì£¼ë¬¸ë²ˆí˜¸ ì°¾ê¸°
        // 4. ì°¾ìœ¼ë©´ OFRë¡œ ìƒíƒœ ì½ê¸°
        // 5. StateFlagë³„ ì²˜ë¦¬
        // 6. ì¬ì ì¬ ë˜ëŠ” ì‚­ì œ
        listEtcGroup.RemoveAt(index);
    }

    // 7. ì¡°ê¸° íƒˆì¶œ
    if (listEtcGroup.Count == 0) break;
}
```

---

## ğŸ“Œ ì£¼ìš” ìƒìˆ˜ ë° ì°¸ê³ 

### Datagrid ì»¬ëŸ¼ (InsungsAct_RcptRegPage.cs Line 88-90)
- `c_nColìƒíƒœ = 1`
- `c_nColì£¼ë¬¸ë²ˆí˜¸ = 2`

### Datagrid êµ¬ì¡°
- y=0: í—¤ë”
- y=1: ë¹ˆ í–‰ (Empty Row)
- y=2~: ë°ì´í„° í–‰

### ëŒ€ê¸° ì‹œê°„
- `c_nWaitShort`: ì§§ì€ ëŒ€ê¸°
- `c_nWaitNormal`: ë³´í†µ ëŒ€ê¸°
- `c_nWaitLong = 250ms`: ê¸´ ëŒ€ê¸°

### ì¬ì‹œë„ íšŸìˆ˜
- `c_nRepeatShort = 3`: 3íšŒ ì¬ì‹œë„

---

## ğŸ”— ìµœê·¼ ì»¤ë°‹

- `a718918` - feat: Insung ì£¼ë¬¸ ìƒíƒœ ê´€ë¦¬ í•¨ìˆ˜ êµ¬í˜„ (Phase 1 - ê³¨ê²© êµ¬í˜„) (2025-11-07)
- `45bf78c` - fix: SignalR ì£¼ë¬¸ ì—…ë°ì´íŠ¸ ì²˜ë¦¬ ë¡œì§ ê°œì„  (2025-11-06)
- `f78e473` - feat: ReEnqueue í•¨ìˆ˜ ê°œì„  ë° Skip case ì²˜ë¦¬ ì¶”ê°€
- `f99e928` - feat: Region 5-3 í˜ì´ì§€ë³„ ê²€ìƒ‰ ë£¨í”„ êµ¬ì¡° êµ¬í˜„
- `40a2161` - feat: Region 5-1, 5-2 êµ¬í˜„ (ê¸°ì¡´ ì£¼ë¬¸ ê´€ë¦¬)

---

**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-11-07
